<!doctype html>
<html class="no-js" lang="en" data-content_root="../../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>hermespy.core.signal_model - HermesPy</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../../../_static/tweaks.css?v=c2f9d16b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #4C8BC6;
  --color-brand-content: #4C8BC6;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">HermesPy</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../../_static/bi.svg" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">HermesPy</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">HermesPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started.html">Getting Started</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../tutorials.html">Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../notebooks/channel.html">Implementing Channels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../notebooks/fec_coding.html">Implementing FEC codings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../notebooks/beamforming_usage.html">Using Beamformers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../notebooks/beamforming_implementation.html">Implementing Beamformers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../notebooks/waveform.html">Implementing Communication Waveforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../notebooks/precoding.html">Implementing Precodings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../notebooks/roc.html">Receiver Operating Characteristics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../notebooks/datasets.html">Recording Datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../notebooks/audio.html">Using Audio Equipment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../notebooks/evaluator.html">Implementing Evaluators</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../api/api.html">HermesPy API</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of HermesPy API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/modem/index.html">Communication</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Communication</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/modem/waveform.html">Waveforms</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Waveforms</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../api/modem/waveform.single_carrier.html">Single Carrier</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Single Carrier</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../api/modem/waveform.single_carrier.FMCW.html">FMCW</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/modem/waveform.single_carrier.RaisedCosine.html">Raised Cosine</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/modem/waveform.single_carrier.Rectangular.html">Rectangular</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/modem/waveform.single_carrier.RootRaisedCosine.html">Root Raised Cosine</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../api/modem/waveforms.orthogonal.html">Orthogonal</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Orthogonal</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5 has-children"><a class="reference internal" href="../../../api/modem/waveforms.orthogonal.ofdm.html">OFDM</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of OFDM</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../api/modem/waveforms.orthogonal.ofdm.OFDMSynchronization.html">OFDM Synchronization</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/modem/waveforms.orthogonal.ofdm.OFDMWaveform.html">OFDM Waveform</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/modem/waveforms.orthogonal.ofdm.SchmidlCoxPilotSection.html">Schmidl Cox Pilot</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/modem/waveforms.orthogonal.ofdm.SchmidlCoxSynchronization.html">Schmidl Cox Synchronization</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/modem/waveforms.orthogonal.ocdm.html">OCDM</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/modem/waveforms.orthogonal.otfs.html">OTFS</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/modem/waveforms.orthogonal.OrthogonalWaveform.html">Waveform</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/modem/waveforms.orthogonal.GridElement.html">Grid Element</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/modem/waveforms.orthogonal.GridResource.html">Resource</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/modem/waveforms.orthogonal.GridSection.html">Section</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/modem/waveforms.orthogonal.GuardSection.html">Guard Section</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/modem/waveforms.orthogonal.PilotSection.html">Pilot Section</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/modem/waveforms.orthogonal.SymbolSection.html">Symbol Section</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/modem/waveform.chirp_fsk.html">C-FSK</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../api/modem/waveform.Synchronization.html">Synchronization</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Synchronization</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../api/modem/waveform.correlation_synchronization.html">Correlation</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/modem/waveform.ChannelEstimation.html">Channel Estimation</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../api/modem/waveform.ChannelEqualization.html">Channel Equalization</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Channel Equalization</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../api/modem/waveform.ZeroForcingChannelEqualization.html">Zero-Forcing</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/modem/waveform.PilotSymbolSequence.html">Pilot Symbol Sequence</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/modem/evaluators.html">Evaluators</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of Evaluators</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/modem/evaluators.ber.html">Bit Error Rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/modem/evaluators.bler.html">Block Error Rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/modem/evaluators.fer.html">Frame Error Rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/modem/evaluators.throughput.html">Throughput</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/modem/evaluators.evm.html">Error Vector Magnitude</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/modem/evaluators.CommunicationEvaluator.html">Communication Evaluator</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/modem/precoding.html">Communication Precoding</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of Communication Precoding</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/modem/precoding.dft.html">Discrete Fourier Transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/modem/precoding.ratio_combining.html">Maximal Ratio Combining</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/modem/precoding.single_carrier.html">Single Carrier Decoding</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/modem/precoding.space_time_block_coding.html">Space-Time Block Codes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/modem/precoding.symbol_precoding.SymbolPrecoding.html">Symbol Precoding</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/modem/symbols.html">Symbols</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/modem/bits_source.html">Bit Sources</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/modem/modem.TransmittingModem.html">Transmitting Modem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/modem/modem.ReceivingModem.html">Receiving Modem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/modem/modem.SimplexLink.html">Simplex Link</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/modem/modem.DuplexModem.html">Duplex Modem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/modem/modem.BaseModem.html">Base Modem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/modem/modem.CommunicationTransmission.html">Transmission</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/modem/modem.CommunicationTransmissionFrame.html">Transmission Frame</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/modem/modem.CommunicationReception.html">Reception</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/modem/modem.CommunicationReceptionFrame.html">Reception Frame</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/modem/mapping.html">Mapping</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/modem/frame_generator.html">Frame Generation</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/radar/index.html">Sensing</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of Sensing</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/radar/radar.Radar.html">Radar</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/radar/radar.RadarReception.html">Radar Reception</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/radar/radar.RadarTransmission.html">Radar Transmission</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/radar/radar.RadarWaveform.html">Radar Waveform</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of Radar Waveform</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/radar/fmcw.html">FMCW</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/radar/cube.RadarCube.html">Radar Cube</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/radar/detection.RadarDetector.html">Radar Detector</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of Radar Detector</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/radar/detection.ThresholdDetector.html">Threshold</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/radar/detection.MaxDetector.html">Max</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/radar/detection.PointDetection.html">Point Detection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/radar/detection.RadarPointCloud.html">Radar Point Cloud</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/radar/evaluators.RadarEvaluator.html">Radar Evaluator</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of Radar Evaluator</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/radar/evaluators.DetectionProbEvaluator.html">Detection Probability Evaluator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/radar/evaluators.ReceiverOperatingCharacteristic.html">Reiver Operating Characteristic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/radar/evaluators.RootMeanSquareError.html">Root Mean Square Error</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/channel/index.html">Channel Modeling</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of Channel Modeling</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/channel/channel.Channel.html">Channel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/channel/channel.ChannelRealization.html">Channel Realization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/channel/channel.ChannelSample.html">Channel Sample</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/channel/channel.LinkState.html">Link State</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/channel/ideal.html">Ideal Channel</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/channel/fading/fading.html">Multipath Fading</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle navigation of Multipath Fading</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/channel/fading/cost259.html">Cost 259</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/channel/fading/exponential.html">Exponential</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/channel/fading/tdl.html">5G TDL</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/channel/fading/fading.AntennaCorrelation.html">Antenna Correlation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/channel/fading/fading.MultipathFadingChannel.html">Multipath Fading Channel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/channel/fading/fading.MultipathFadingRealization.html">Multipath Fading Realization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/channel/fading/fading.MultipathFadingSample.html">Multipath Fading Sample</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/channel/cdl/cluster_delay_lines.html">3GPP Cluster Delay Line Models</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle navigation of 3GPP Cluster Delay Line Models</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/channel/cdl/cdl.html">Static CDL</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/channel/cdl/indoor_factory.html">Indoor Factory</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/channel/cdl/indoor_office.html">Indoor Office</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/channel/cdl/rural_macrocells.html">Rural Macrocells</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/channel/cdl/urban_macrocells.html">Urban Macrocells</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/channel/cdl/urban_microcells.html">Urban Microcells</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/channel/delay/delay.html">Delay Channels</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle navigation of Delay Channels</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/channel/delay/spatial.html">Spatial Delay Channel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/channel/delay/random.html">Random Delay Channel</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/channel/radar/radar.html">Radar Channels</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle navigation of Radar Channels</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/channel/radar/single.html">Single Target</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/channel/radar/multi.html">Multi Target</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/channel/quadriga.html">Quadriga</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/channel/sionna-rt.html">SionnaRT Channel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/channel/consistent.html">Spatial Consistency</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/simulation/index.html">Simulation</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle navigation of Simulation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/simulation/simulation.Simulation.html">Simulation</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/simulation/simulated_device.html">Devices</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle navigation of Devices</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/simulation/simulated_device.SimulatedDeviceOutput.html">Device Output</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/simulation/simulated_device.SimulatedDeviceReceiveRealization.html">Receive Realization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/simulation/simulated_device.SimulatedDeviceReception.html">Device Reception</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/simulation/simulated_device.SimulatedDeviceTransmission.html">Device Transmission</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/simulation/simulated_device.ProcessedSimulatedDeviceInput.html">Processed Input</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/simulation/animation.html">Animation</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/simulation/antennas.html">Antennas</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle navigation of Antennas</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../api/simulation/antennas.SimulatedAntennaArray.html">Antenna Arrays</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><div class="visually-hidden">Toggle navigation of Antenna Arrays</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../api/simulation/antennas.SimulatedCustomArray.html">Custom Array</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/simulation/antennas.SimulatedUniformArray.html">Uniform Array</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../api/simulation/antennas.SimulatedAntenna.html">Antenna</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><div class="visually-hidden">Toggle navigation of Antenna</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../api/simulation/antennas.SimulatedDipole.html">Dipole</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/simulation/antennas.SimulatedIdealAntenna.html">Ideal Isotropic</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/simulation/antennas.SimulatedLinearAntenna.html">Linear</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/simulation/antennas.SimulatedPatchAntenna.html">Patch</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/simulation/antennas.SimulatedAntennaPort.html">Antenna Port</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/simulation/noise.html">Noise</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><div class="visually-hidden">Toggle navigation of Noise</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/simulation/noise.model.AWGN.html">AWGN Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/simulation/noise.model.AWGNRealization.html">AWGN Realization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/simulation/noise.level.N0.html">N0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/simulation/noise.level.SNR.html">SNR</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/simulation/modem.noise.EBN0.html">EBN0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/simulation/modem.noise.ESN0.html">ESN0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/simulation/modem.noise.CommunicationNoiseLevel.html">Communication Noise Level</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/simulation/synchronization.html">Synchronization</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" role="switch" type="checkbox"/><label for="toctree-checkbox-27"><div class="visually-hidden">Toggle navigation of Synchronization</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/simulation/synchronization.TriggerModel.html">Trigger Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/simulation/synchronization.TriggerRealization.html">Trigger Realization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/simulation/synchronization.StaticTrigger.html">Static Trigger</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/simulation/synchronization.RandomTrigger.html">Random Trigger</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/simulation/synchronization.SampleOffsetTrigger.html">Sample Offset Trigger</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/simulation/synchronization.TimeOffsetTrigger.html">Time Offset Trigger</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/simulation/rf_chain.adc.html">A/D Conversion</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" role="switch" type="checkbox"/><label for="toctree-checkbox-28"><div class="visually-hidden">Toggle navigation of A/D Conversion</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/simulation/rf_chain.adc.AnalogDigitalConverter.html">Analog Digital Converter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/simulation/rf_chain.adc.AutomaticGainControl.html">Automatic Gain Control</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/simulation/rf_chain.adc.Gain.html">Constant Gain</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/simulation/rf_chain.adc.GainControlBase.html">Gain Control Base</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/simulation/rf_chain.adc.GainControlType.html">Gain Control Type</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/simulation/rf_chain.adc.QuantizerType.html">Quantizer Type</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/simulation/rf_chain.html">Radio-Frequency Chain</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/simulation/rf_chain.phase_noise.html">Phase Noise</a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" role="switch" type="checkbox"/><label for="toctree-checkbox-29"><div class="visually-hidden">Toggle navigation of Phase Noise</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/simulation/rf_chain.phase_noise.NoPhaseNoise.html">No Phase Noise</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/simulation/rf_chain.phase_noise.OscillatorPhaseNoise.html">Oscillator Phase Noise</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/simulation/rf_chain.amplifier.html">Amplification</a><input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" role="switch" type="checkbox"/><label for="toctree-checkbox-30"><div class="visually-hidden">Toggle navigation of Amplification</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/simulation/rf_chain.amplifier.ClippingPowerAmplifier.html">Clipping Power Amplifier</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/simulation/rf_chain.amplifier.CustomPowerAmplifier.html">Custom Power Amplifier</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/simulation/rf_chain.amplifier.PowerAmplifier.html">Power Amplifier</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/simulation/rf_chain.amplifier.RappPowerAmplifier.html">Rapp Power Amplifier</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/simulation/rf_chain.amplifier.SalehPowerAmplifier.html">Saleh Power Amplifier</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/simulation/coupling.html">Mutual Coupling</a><input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" role="switch" type="checkbox"/><label for="toctree-checkbox-31"><div class="visually-hidden">Toggle navigation of Mutual Coupling</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/simulation/coupling.perfect.html">Perfect Coupling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/simulation/coupling.impedance.html">Impedance Coupling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/simulation/coupling.coupling.html">Coupling</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/simulation/isolation.html">Isolation</a><input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" role="switch" type="checkbox"/><label for="toctree-checkbox-32"><div class="visually-hidden">Toggle navigation of Isolation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/simulation/isolation.isolation.html">Isolation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/simulation/isolation.perfect.html">Perfect Isolation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/simulation/isolation.selective.html">Selective Leakage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/simulation/isolation.specific.html">Specific Isolation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/simulation/evaluators.html">Evaluators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/simulation/scenario.SimulationScenario.html">Simulation Scenario</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/simulation/scenario.ScenarioVisualization.html">Scenario Visualization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/simulation/scenario.ScenarioVisualizer.html">Scenario Visualizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/simulation/drop.SimulatedDrop.html">Simulated Drop</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/simulation/beamforming.DeviceFocus.html">Device Focus</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/hardware_loop/index.html">Hardware Loop</a><input class="toctree-checkbox" id="toctree-checkbox-33" name="toctree-checkbox-33" role="switch" type="checkbox"/><label for="toctree-checkbox-33"><div class="visually-hidden">Toggle navigation of Hardware Loop</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/hardware_loop/hardware_loop.HardwareLoop.html">Hardaware Loop</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/hardware_loop/scenario.PhysicalScenario.html">Physical Scenario</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/hardware_loop/physical_device.PhysicalDevice.html">Physical Device</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/hardware_loop/physical_device_dummy.PhysicalDeviceDummy.html">Physical Device Dummy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/hardware_loop/physical_device_dummy.PhysicalScenarioDummy.html">Physical Scenario Dummy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/hardware_loop/hardware_loop.HardwareLoopPlot.html">Hardware Loop Plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/hardware_loop/visualizers.html">Visualization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/hardware_loop/uhd.usrp.UsrpDevice.html">USRP Device</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/hardware_loop/uhd.system.UsrpSystem.html">USRP System</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/hardware_loop/audio.device.AudioDevice.html">Audio Device</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/hardware_loop/audio.scenario.AudioScenario.html">Audio Scenario</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/hardware_loop/calibration.delay.html">Delay Calibration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/hardware_loop/calibration.leakage.html">Leakage Calibration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/hardware_loop/calibration.antenna.html">Antenna Calibration</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/core/index.html">Core</a><input class="toctree-checkbox" id="toctree-checkbox-34" name="toctree-checkbox-34" role="switch" type="checkbox"/><label for="toctree-checkbox-34"><div class="visually-hidden">Toggle navigation of Core</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/core/device.Device.html">Device Model</a><input class="toctree-checkbox" id="toctree-checkbox-35" name="toctree-checkbox-35" role="switch" type="checkbox"/><label for="toctree-checkbox-35"><div class="visually-hidden">Toggle navigation of Device Model</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core/device.DeviceInput.html">Device Input</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core/device.DeviceOutput.html">Device Output</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core/device.DeviceReception.html">Device Reception</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core/device.DeviceTransmission.html">Device Transmission</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core/device.MixingOperator.html">Mixing Operator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core/device.OperationResult.html">Operation Result</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core/device.Operator.html">Operator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core/device.ProcessedDeviceInput.html">Processed Device Input</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core/device.Receiver.html">Receiver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core/device.Reception.html">DSP Reception</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core/device.Transmission.html">DSP Transmission</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core/device.Transmitter.html">Transmitter</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core/scenario.html">Wireless Scenario</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core/monte_carlo.html">PyMonte</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core/signal.html">Signal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core/antennas.html">Antenna Descriptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core/channel.html">Channel State Information</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core/drop.html">Drop</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core/factory.html">Serialization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core/evaluators.html">Evaluators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core/hooks.html">Hooks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core/operators.html">Extra Operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core/precoding.html">Precoding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core/random_node.html">Random Graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core/state.html">State</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core/transformation.html">Coordinate System</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core/visualize.html">Visualization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core/executable.html">Executable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core/pipeline.html">Pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core/logarithmic.html">Logarithmics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core/definitions.html">General Definitions</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/fec/index.html">Error Correction</a><input class="toctree-checkbox" id="toctree-checkbox-36" name="toctree-checkbox-36" role="switch" type="checkbox"/><label for="toctree-checkbox-36"><div class="visually-hidden">Toggle navigation of Error Correction</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/fec/coding.html">Coding Pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/fec/bch.html">BCH Coding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/fec/block_interleaver.html">Interleaving</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/fec/crc.html">Cyclic Redundancy Checks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/fec/ldpc.html">Low Differential Parity Checks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/fec/polar.html">Polar Coding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/fec/repetition.html">Repetition Coding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/fec/rs.html">Reed-Solomon Coding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/fec/rsc.html">RSC Coding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/fec/scrambler.html">Scrambling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/fec/turbo.html">Turbo Coding</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/jcas/index.html">JCAS</a><input class="toctree-checkbox" id="toctree-checkbox-37" name="toctree-checkbox-37" role="switch" type="checkbox"/><label for="toctree-checkbox-37"><div class="visually-hidden">Toggle navigation of JCAS</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jcas/matched_filtering.html">Matched Filtering</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jcas/ofdm_radar.html">OFDM Radar</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jcas/jcas.html">Duplex JCAS Operator</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/beamforming/index.html">Beamforming</a><input class="toctree-checkbox" id="toctree-checkbox-38" name="toctree-checkbox-38" role="switch" type="checkbox"/><label for="toctree-checkbox-38"><div class="visually-hidden">Toggle navigation of Beamforming</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/beamforming/beamformer.html">Beamformer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/beamforming/conventional.html">Conventional Beamformer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/beamforming/capon.html">Capon Beamformer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/beamforming/nullsteeringbeamformer.html">Null Steering Beamformer</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/tools/index.html">Tools</a><input class="toctree-checkbox" id="toctree-checkbox-39" name="toctree-checkbox-39" role="switch" type="checkbox"/><label for="toctree-checkbox-39"><div class="visually-hidden">Toggle navigation of Tools</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/tools/math.html">Math Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/tools/resampling.html">Resampling Routines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/tools/tile.html">Tile Figures</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../matlab.html">Matlab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developer_hints.html">For Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../license.html">License</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <h1>Source code for hermespy.core.signal_model</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">__future__</span><span class="w"> </span><span class="kn">import</span> <span class="n">annotations</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">copy</span><span class="w"> </span><span class="kn">import</span> <span class="n">deepcopy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Literal</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Type</span><span class="p">,</span> <span class="n">Any</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">ABC</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.lines</span><span class="w"> </span><span class="kn">import</span> <span class="n">Line2D</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">numba</span><span class="w"> </span><span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">complex128</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.constants</span><span class="w"> </span><span class="kn">import</span> <span class="n">pi</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.fft</span><span class="w"> </span><span class="kn">import</span> <span class="n">fft</span><span class="p">,</span> <span class="n">fftshift</span><span class="p">,</span> <span class="n">fftfreq</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.ndimage</span><span class="w"> </span><span class="kn">import</span> <span class="n">convolve1d</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="kn">import</span> <span class="n">butter</span><span class="p">,</span> <span class="n">sosfilt</span><span class="p">,</span> <span class="n">firwin</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">.factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">Serializable</span><span class="p">,</span> <span class="n">SerializationProcess</span><span class="p">,</span> <span class="n">DeserializationProcess</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.visualize</span><span class="w"> </span><span class="kn">import</span> <span class="n">PlotVisualization</span><span class="p">,</span> <span class="n">VAT</span><span class="p">,</span> <span class="n">VisualizableAttribute</span>

<span class="n">__author__</span> <span class="o">=</span> <span class="s2">&quot;Jan Adler&quot;</span>
<span class="n">__copyright__</span> <span class="o">=</span> <span class="s2">&quot;Copyright 2024, Barkhausen Institut gGmbH&quot;</span>
<span class="n">__credits__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Jan Adler&quot;</span><span class="p">]</span>
<span class="n">__license__</span> <span class="o">=</span> <span class="s2">&quot;AGPLv3&quot;</span>
<span class="n">__version__</span> <span class="o">=</span> <span class="s2">&quot;1.5.0&quot;</span>
<span class="n">__maintainer__</span> <span class="o">=</span> <span class="s2">&quot;Jan Adler&quot;</span>
<span class="n">__email__</span> <span class="o">=</span> <span class="s2">&quot;jan.adler@barkhauseninstitut.org&quot;</span>
<span class="n">__status__</span> <span class="o">=</span> <span class="s2">&quot;Prototype&quot;</span>


<div class="viewcode-block" id="_SignalVisualization">
<a class="viewcode-back" href="../../../api/core/signal.html#hermespy.core.signal_model._SignalVisualization">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">_SignalVisualization</span><span class="p">(</span><span class="n">VisualizableAttribute</span><span class="p">[</span><span class="n">PlotVisualization</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Visualization of signal samples.&quot;&quot;&quot;</span>

    <span class="n">__signal</span><span class="p">:</span> <span class="n">Signal</span>  <span class="c1"># The signal model to be visualized</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">signal</span><span class="p">:</span> <span class="n">Signal</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>

<span class="sd">            signal: The signal model to be visualized.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Initialize base class</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="c1"># Initialize class attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__signal</span> <span class="o">=</span> <span class="n">signal</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">signal</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Signal</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The signal model to be visualized.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__signal</span></div>



<div class="viewcode-block" id="_SamplesVisualization">
<a class="viewcode-back" href="../../../api/core/signal.html#hermespy.core.signal_model._SamplesVisualization">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">_SamplesVisualization</span><span class="p">(</span><span class="n">_SignalVisualization</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Visualize the samples of a signal model.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">title</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">title</span>

<div class="viewcode-block" id="_SamplesVisualization.create_figure">
<a class="viewcode-back" href="../../../api/core/signal.html#hermespy.core.signal_model._SamplesVisualization.create_figure">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_figure</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">space</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;frequency&quot;</span><span class="p">,</span> <span class="s2">&quot;both&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">FigureBase</span><span class="p">,</span> <span class="n">VAT</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">num_streams</span><span class="p">,</span> <span class="mi">2</span> <span class="k">if</span> <span class="n">space</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span> <span class="k">else</span> <span class="mi">1</span><span class="p">,</span> <span class="n">squeeze</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">_prepare_visualization</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">figure</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Figure</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">axes</span><span class="p">:</span> <span class="n">VAT</span><span class="p">,</span>
        <span class="n">angle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">space</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;frequency&quot;</span><span class="p">,</span> <span class="s2">&quot;both&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;both&quot;</span><span class="p">,</span>
        <span class="n">legend</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PlotVisualization</span><span class="p">:</span>
        <span class="c1"># Prepare axes and lines</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">object_</span><span class="p">)</span>
        <span class="n">zeros</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">num_samples</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
        <span class="n">timestamps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">timestamps</span>
        <span class="k">for</span> <span class="n">stream_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">num_streams</span><span class="p">):</span>
            <span class="n">ax_y_idx</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="n">space</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">}:</span>
                <span class="n">ax</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">stream_idx</span><span class="p">,</span> <span class="n">ax_y_idx</span><span class="p">]</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Amplitude&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">stream_idx</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">num_streams</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time-Domain [s]&quot;</span><span class="p">)</span>
                <span class="n">time_lines</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">timestamps</span><span class="p">,</span> <span class="n">zeros</span><span class="p">)</span> <span class="o">+</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">timestamps</span><span class="p">,</span> <span class="n">zeros</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">legend</span> <span class="ow">and</span> <span class="n">stream_idx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">time_lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Real&quot;</span><span class="p">)</span>
                    <span class="n">time_lines</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Imag&quot;</span><span class="p">)</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper center&quot;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">),</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                <span class="n">lines</span><span class="p">[</span><span class="n">stream_idx</span><span class="p">,</span> <span class="n">ax_y_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">time_lines</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">time_lines</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">time_lines</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">ax_y_idx</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="k">if</span> <span class="n">space</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="s2">&quot;frequency&quot;</span><span class="p">}:</span>
                <span class="n">freq_ax</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">stream_idx</span><span class="p">,</span> <span class="n">ax_y_idx</span><span class="p">]</span>
                <span class="n">freq_ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Abs&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">stream_idx</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">num_streams</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">freq_ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Frequency-Domain [Hz]&quot;</span><span class="p">)</span>
                <span class="n">frequency_lines</span> <span class="o">=</span> <span class="n">freq_ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">timestamps</span><span class="p">,</span> <span class="n">zeros</span><span class="p">)</span>
                <span class="n">freq_ax</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">frequency_lines</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

                <span class="k">if</span> <span class="n">angle</span><span class="p">:</span>
                    <span class="n">phase_axis</span> <span class="o">=</span> <span class="n">freq_ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
                    <span class="n">frequency_lines</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">freq_ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">timestamps</span><span class="p">,</span> <span class="n">zeros</span><span class="p">))</span>
                    <span class="n">phase_axis</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Angle [Rad]&quot;</span><span class="p">)</span>
                <span class="n">lines</span><span class="p">[</span><span class="n">stream_idx</span><span class="p">,</span> <span class="n">ax_y_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">frequency_lines</span>

        <span class="k">return</span> <span class="n">PlotVisualization</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">lines</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_update_visualization</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">visualization</span><span class="p">:</span> <span class="n">PlotVisualization</span><span class="p">,</span>
        <span class="n">space</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;frequency&quot;</span><span class="p">,</span> <span class="s2">&quot;both&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;both&quot;</span><span class="p">,</span>
        <span class="n">angle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Generate timestamps for time-domain plotting</span>
        <span class="n">timestamps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">timestamps</span>

        <span class="c1"># Infer the axis indices to account for different plot</span>
        <span class="n">time_axis_idx</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">frequency_axis_idx</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">space</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span> <span class="k">else</span> <span class="mi">0</span>

        <span class="c1"># Generate / collect the data to be plotted</span>
        <span class="k">for</span> <span class="n">stream_samples</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">lines</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">getitem</span><span class="p">(),</span> <span class="n">visualization</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span> <span class="n">visualization</span><span class="o">.</span><span class="n">lines</span>
        <span class="p">):</span>
            <span class="c1"># Plot time space</span>
            <span class="k">if</span> <span class="n">space</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">}:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">num_samples</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">axes</span><span class="p">[</span><span class="n">time_axis_idx</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;NO SAMPLES&quot;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">lines</span><span class="p">[</span><span class="n">time_axis_idx</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">timestamps</span><span class="p">,</span> <span class="n">stream_samples</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
                    <span class="n">lines</span><span class="p">[</span><span class="n">time_axis_idx</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">timestamps</span><span class="p">,</span> <span class="n">stream_samples</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span>

                <span class="c1"># Rescale axes</span>
                <span class="n">axes</span><span class="p">[</span><span class="n">time_axis_idx</span><span class="p">]</span><span class="o">.</span><span class="n">relim</span><span class="p">()</span>
                <span class="n">axes</span><span class="p">[</span><span class="n">time_axis_idx</span><span class="p">]</span><span class="o">.</span><span class="n">autoscale_view</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

            <span class="c1"># Plot frequency space</span>
            <span class="k">if</span> <span class="n">space</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="s2">&quot;frequency&quot;</span><span class="p">}:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">num_samples</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">axes</span><span class="p">[</span><span class="n">frequency_axis_idx</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
                        <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;NO SAMPLES&quot;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span>
                    <span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">frequencies</span> <span class="o">=</span> <span class="n">fftshift</span><span class="p">(</span>
                        <span class="n">fftfreq</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">num_samples</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">)</span>
                    <span class="p">)</span>
                    <span class="n">bins</span> <span class="o">=</span> <span class="n">fftshift</span><span class="p">(</span><span class="n">fft</span><span class="p">(</span><span class="n">stream_samples</span><span class="p">))</span>
                    <span class="n">lines</span><span class="p">[</span><span class="n">frequency_axis_idx</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">bins</span><span class="p">))</span>

                <span class="k">if</span> <span class="n">angle</span><span class="p">:</span>
                    <span class="n">lines</span><span class="p">[</span><span class="n">frequency_axis_idx</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">bins</span><span class="p">))</span>

                <span class="c1"># Rescale axes</span>
                <span class="n">axes</span><span class="p">[</span><span class="n">frequency_axis_idx</span><span class="p">]</span><span class="o">.</span><span class="n">relim</span><span class="p">()</span>
                <span class="n">axes</span><span class="p">[</span><span class="n">frequency_axis_idx</span><span class="p">]</span><span class="o">.</span><span class="n">autoscale_view</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span></div>



<div class="viewcode-block" id="_EyeVisualization">
<a class="viewcode-back" href="../../../api/core/signal.html#hermespy.core.signal_model._EyeVisualization">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">_EyeVisualization</span><span class="p">(</span><span class="n">_SignalVisualization</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Visualize the eye diagram of a signal model.</span>

<span class="sd">    Depending on the `domain` flag the eye diagram will either be rendered with the time-domain on the plot&#39;s x-axis</span>

<span class="sd">    .. plot::</span>

<span class="sd">        import matplotlib.pyplot as plt</span>

<span class="sd">        from hermespy.simulation import SimulatedDevice</span>
<span class="sd">        from hermespy.modem import TransmittingModem, RaisedCosineWaveform</span>

<span class="sd">        device = SimulatedDevice()</span>
<span class="sd">        transmitter = TransmittingModem()</span>
<span class="sd">        waveform = RaisedCosineWaveform(modulation_order=16, oversampling_factor=16, num_preamble_symbols=0, symbol_rate=1e8, num_data_symbols=1000, roll_off=.9)</span>
<span class="sd">        transmitter.waveform = waveform</span>
<span class="sd">        device.add_dsp(transmitter)</span>

<span class="sd">        device.transmit().mixed_signal.eye(symbol_duration=1/waveform.symbol_rate, domain=&#39;time&#39;)</span>
<span class="sd">        plt.show()</span>


<span class="sd">    or on the complex plane</span>

<span class="sd">    .. plot::</span>

<span class="sd">        import matplotlib.pyplot as plt</span>

<span class="sd">        from hermespy.simulation import SimulatedDevice</span>
<span class="sd">        from hermespy.modem import TransmittingModem, RaisedCosineWaveform</span>

<span class="sd">        device = SimulatedDevice()</span>
<span class="sd">        transmitter = TransmittingModem()</span>
<span class="sd">        waveform = RaisedCosineWaveform(modulation_order=16, oversampling_factor=16, num_preamble_symbols=0, symbol_rate=1e8, num_data_symbols=1000, roll_off=.9)</span>
<span class="sd">        transmitter.waveform = waveform</span>
<span class="sd">        device.add_dsp(transmitter)</span>

<span class="sd">        device.transmit().mixed_signal.eye(symbol_duration=1/waveform.symbol_rate, domain=&#39;complex&#39;)</span>
<span class="sd">        plt.show()</span>

<span class="sd">    Args:</span>

<span class="sd">        symbol_duration:</span>
<span class="sd">            Assumed symbol repetition interval in seconds.</span>
<span class="sd">            Will be rounded to match the signal model&#39;s sampling rate.</span>

<span class="sd">        line_width:</span>
<span class="sd">            Line width of a single plot line.</span>

<span class="sd">        title:</span>
<span class="sd">            Title of the plotted figure.</span>
<span class="sd">            `Eye Diagram` by default.</span>

<span class="sd">        domain:</span>
<span class="sd">            Plotting behaviour of the eye diagram.</span>
<span class="sd">            `time` by default.</span>
<span class="sd">            See above examples for rendered results.</span>

<span class="sd">        legend:</span>
<span class="sd">            Display a plot legend.</span>
<span class="sd">            Enabled by default.</span>
<span class="sd">            Only considered when in `time` domain plotting mode.</span>

<span class="sd">        linewidth:</span>
<span class="sd">            Line width of the eye plot.</span>
<span class="sd">            :math:`.75` by default.</span>

<span class="sd">        symbol_cutoff:</span>
<span class="sd">            Relative amount of symbols ignored during plotting.</span>
<span class="sd">            :math:`0.1` by default.</span>
<span class="sd">            This is required to properly visualize intersymbol interferences within the communication frame,</span>
<span class="sd">            since special effects may occur at the start and end.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">title</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Eye Diagram&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_prepare_visualization</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">figure</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Figure</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">axes</span><span class="p">:</span> <span class="n">VAT</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">symbol_duration</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">domain</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;complex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span>
        <span class="n">legend</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">,</span>
        <span class="n">symbol_cutoff</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PlotVisualization</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">linewidth</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Plot line width must be greater than zero (not </span><span class="si">{</span><span class="n">linewidth</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">symbol_cutoff</span> <span class="o">&lt;</span> <span class="mf">0.0</span> <span class="ow">or</span> <span class="n">symbol_cutoff</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Symbol cutoff must be in the interval [0, 1] (not </span><span class="si">{</span><span class="n">symbol_cutoff</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

        <span class="n">_ax</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_color_cycle</span><span class="p">()</span>

        <span class="n">_symbol_duration</span> <span class="o">=</span> <span class="n">symbol_duration</span> <span class="k">if</span> <span class="n">symbol_duration</span> <span class="k">else</span> <span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">sampling_rate</span>
        <span class="n">symbol_num_samples</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">_symbol_duration</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">)</span>
        <span class="n">num_symbols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">num_samples</span> <span class="o">//</span> <span class="n">symbol_num_samples</span>
        <span class="n">num_cutoff_symbols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_symbols</span> <span class="o">*</span> <span class="n">symbol_cutoff</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">num_cutoff_symbols</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">num_cutoff_symbols</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">values_per_symbol</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">symbol_num_samples</span> <span class="o">+</span> <span class="mi">2</span>
        <span class="n">num_visualized_symbols</span> <span class="o">=</span> <span class="n">num_symbols</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">num_cutoff_symbols</span>

        <span class="n">lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Line2D</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">domain</span> <span class="o">==</span> <span class="s2">&quot;time&quot;</span><span class="p">:</span>
            <span class="n">_ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time-Domain [s]&quot;</span><span class="p">)</span>
            <span class="n">_ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Normalized Amplitude&quot;</span><span class="p">)</span>
            <span class="n">_ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">))</span>
            <span class="n">_ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>

            <span class="n">timestamps</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">symbol_num_samples</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">symbol_num_samples</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">symbol_num_samples</span>
            <span class="p">)</span>
            <span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">timestamps</span><span class="p">]</span> <span class="o">*</span> <span class="n">num_visualized_symbols</span><span class="p">)</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
            <span class="n">values</span><span class="p">[::</span><span class="n">values_per_symbol</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">)</span>

            <span class="n">lines</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">_ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">))</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">_ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
                <span class="n">legend_elements</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Real&quot;</span><span class="p">),</span>
                    <span class="n">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Imag&quot;</span><span class="p">),</span>
                <span class="p">]</span>
                <span class="n">_ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">legend_elements</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span> <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">domain</span> <span class="o">==</span> <span class="s2">&quot;complex&quot;</span><span class="p">:</span>
            <span class="n">_ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Real&quot;</span><span class="p">)</span>
            <span class="n">_ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Imag&quot;</span><span class="p">)</span>

            <span class="n">num_cutoff_samples</span> <span class="o">=</span> <span class="n">num_cutoff_symbols</span> <span class="o">*</span> <span class="n">symbol_num_samples</span>
            <span class="n">stream_slice</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">getitem</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="nb">slice</span><span class="p">(</span><span class="n">num_cutoff_samples</span><span class="p">,</span> <span class="o">-</span><span class="n">num_cutoff_samples</span><span class="p">)))</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                <span class="n">_ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">stream_slice</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">stream_slice</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unsupported plotting domain &#39;</span><span class="si">{</span><span class="n">domain</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

        <span class="n">lines_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">object_</span><span class="p">)</span>
        <span class="n">lines_array</span><span class="o">.</span><span class="n">flat</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">lines</span>
        <span class="k">return</span> <span class="n">PlotVisualization</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">lines_array</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_update_visualization</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">visualization</span><span class="p">:</span> <span class="n">PlotVisualization</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">symbol_duration</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">domain</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;complex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span>
        <span class="n">symbol_cutoff</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">_symbol_duration</span> <span class="o">=</span> <span class="n">symbol_duration</span> <span class="k">if</span> <span class="n">symbol_duration</span> <span class="k">else</span> <span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">sampling_rate</span>
        <span class="n">symbol_num_samples</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">_symbol_duration</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">)</span>
        <span class="n">num_symbols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">num_samples</span> <span class="o">//</span> <span class="n">symbol_num_samples</span>
        <span class="n">num_cutoff_symbols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_symbols</span> <span class="o">*</span> <span class="n">symbol_cutoff</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">num_cutoff_symbols</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">num_cutoff_symbols</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">values_per_symbol</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">symbol_num_samples</span> <span class="o">+</span> <span class="mi">2</span>
        <span class="n">num_visualized_symbols</span> <span class="o">=</span> <span class="n">num_symbols</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">num_cutoff_symbols</span>

        <span class="n">samples</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">getitem</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">domain</span> <span class="o">==</span> <span class="s2">&quot;time&quot;</span><span class="p">:</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">num_visualized_symbols</span> <span class="o">*</span> <span class="n">values_per_symbol</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_symbols</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">num_cutoff_symbols</span><span class="p">):</span>
                <span class="n">sample_offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="n">num_cutoff_symbols</span><span class="p">)</span> <span class="o">*</span> <span class="n">symbol_num_samples</span>
                <span class="n">values</span><span class="p">[</span><span class="n">n</span> <span class="o">*</span> <span class="n">values_per_symbol</span> <span class="p">:</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">values_per_symbol</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">samples</span><span class="p">[</span>
                    <span class="mi">0</span><span class="p">,</span> <span class="n">sample_offset</span> <span class="p">:</span> <span class="n">sample_offset</span> <span class="o">+</span> <span class="n">values_per_symbol</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="p">]</span>
            <span class="n">values</span><span class="p">[</span><span class="n">values_per_symbol</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">::</span> <span class="n">values_per_symbol</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">)</span>

            <span class="c1"># Normalize values</span>
            <span class="n">abs_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">samples</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">abs_value</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="n">values</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">values</span><span class="p">))</span>

            <span class="c1"># Update plot lines</span>
            <span class="n">visualization</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">flat</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="n">values</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
            <span class="n">visualization</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">flat</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="n">values</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">domain</span> <span class="o">==</span> <span class="s2">&quot;complex&quot;</span><span class="p">:</span>
            <span class="n">num_cutoff_samples</span> <span class="o">=</span> <span class="n">num_cutoff_symbols</span> <span class="o">*</span> <span class="n">symbol_num_samples</span>
            <span class="n">stream_slice</span> <span class="o">=</span> <span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_cutoff_samples</span><span class="p">:</span><span class="o">-</span><span class="n">num_cutoff_samples</span><span class="p">]</span>

            <span class="n">visualization</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">flat</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">stream_slice</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">stream_slice</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span></div>



<div class="viewcode-block" id="SignalBlock">
<a class="viewcode-back" href="../../../api/core/signal.html#hermespy.core.signal_model.SignalBlock">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">SignalBlock</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Serializable</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A TxN matrix of complex entries representing signal samples over T streams and N time samples.</span>
<span class="sd">    Used in Signal to store pieces of signal samples.</span>
<span class="sd">    Use \&quot;offset\&quot; property to set the offset of this block relative to a signal start sample.&quot;&quot;&quot;</span>

    <span class="n">_offset</span><span class="p">:</span> <span class="nb">int</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">samples</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SignalBlock</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new SignalBlock instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            samples:</span>
<span class="sd">                The object to be converted to a 2D matrix. Arrays of higher dim count are not allowed. Uses np.asarray for conversion.</span>

<span class="sd">            offset:</span>
<span class="sd">                Integer offset of this block in a signal model</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError:</span>
<span class="sd">                If ndim of given samples is bigger then 2.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Create a ndarray</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>

        <span class="c1"># Add streams dim if only one stream was passed</span>
        <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
        <span class="c1"># Validate</span>
        <span class="k">elif</span> <span class="n">obj</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Samples must have ndim &lt;= 2 (</span><span class="si">{</span><span class="n">obj</span><span class="o">.</span><span class="n">ndim</span><span class="si">}</span><span class="s2"> was given)&quot;</span><span class="p">)</span>

        <span class="c1"># Cast it to SignalBlock</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>

        <span class="c1"># Assign attributes</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="n">offset</span>  <span class="c1"># type: ignore</span>

        <span class="k">return</span> <span class="n">obj</span>  <span class="c1"># type: ignore</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__array_finalize__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="n">SignalBlock</span> <span class="o">|</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>  <span class="c1"># pragma: no cover</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;offset&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SignalBlock</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">SignalBlock</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">num_streams</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The number of streams within this signal block.</span>

<span class="sd">        Returns: The number of streams.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">num_samples</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The number of samples within this signal block.</span>

<span class="sd">        Returns: The number of samples.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">offset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get block&#39;s offset&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_offset</span>

    <span class="nd">@offset</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set block&#39;s offset&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Offset must be non-zero&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_offset</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">end</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get block stop sample.</span>
<span class="sd">        b.num_samples = b.end - b.off&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_offset</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">power</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute power of the modeled signal.</span>

<span class="sd">        Returns: The power of each modeled stream as a numpy vector.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_samples</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">energy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the energy of the modeled signal.</span>

<span class="sd">        Returns: The energy of each modeled stream as a numpy vector.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">real</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">imag</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>

<div class="viewcode-block" id="SignalBlock.copy">
<a class="viewcode-back" href="../../../api/core/signal.html#hermespy.core.signal_model.SignalBlock.copy">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;K&quot;</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SignalBlock</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Copy this signal block to a new object.</span>

<span class="sd">        Args:</span>
<span class="sd">            order: Ignored.</span>

<span class="sd">        Returns: A copy of this signal model.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">order</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;order argument is not supported&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>


<div class="viewcode-block" id="SignalBlock.resample">
<a class="viewcode-back" href="../../../api/core/signal.html#hermespy.core.signal_model.SignalBlock.resample">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">resample</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">sampling_rate_old</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">sampling_rate_new</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">aliasing_filter</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SignalBlock</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Resample a signal block to a different sampling rate.</span>

<span class="sd">        Args:</span>

<span class="sd">            sampling_rate_old:</span>
<span class="sd">                Old sampling rate of the signal block in Hz.</span>

<span class="sd">            sampling_rate_new:</span>
<span class="sd">                New sampling rate of the signal block in Hz.</span>

<span class="sd">            aliasing_filter:</span>
<span class="sd">                Apply an anti-aliasing filter during downsampling.</span>
<span class="sd">                Enabled by default.</span>

<span class="sd">        Returns: The resampled signal block.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If `sampling_rate_old` or `sampling_rate_new` are smaller or equal to zero.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Validate given sampling rate</span>
        <span class="k">if</span> <span class="n">sampling_rate_old</span> <span class="o">&lt;=</span> <span class="mf">0.0</span> <span class="ow">or</span> <span class="n">sampling_rate_new</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sampling rate must be greater than zero.&quot;</span><span class="p">)</span>

        <span class="c1"># Skip resampling if the same sampling rate was given</span>
        <span class="k">if</span> <span class="n">sampling_rate_old</span> <span class="o">==</span> <span class="n">sampling_rate_new</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># Avoid resampling if this block does not contain samples</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_samples</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># Init</span>
        <span class="n">samples_new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># Apply anti-aliasing if requested and downsampled</span>
        <span class="k">if</span> <span class="n">aliasing_filter</span> <span class="ow">and</span> <span class="n">sampling_rate_new</span> <span class="o">&lt;</span> <span class="n">sampling_rate_old</span><span class="p">:</span>
            <span class="n">samples_new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resample_antialiasing</span><span class="p">(</span>
                <span class="n">samples_new</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">sampling_rate_new</span> <span class="o">/</span> <span class="n">sampling_rate_old</span>
            <span class="p">)</span>

        <span class="c1"># Resample</span>
        <span class="n">samples_new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resample</span><span class="p">(</span><span class="n">samples_new</span><span class="p">,</span> <span class="n">sampling_rate_old</span><span class="p">,</span> <span class="n">sampling_rate_new</span><span class="p">)</span>

        <span class="c1"># Apply anti-aliasing if requested and upsampled</span>
        <span class="k">if</span> <span class="n">aliasing_filter</span> <span class="ow">and</span> <span class="n">sampling_rate_new</span> <span class="o">&gt;</span> <span class="n">sampling_rate_old</span><span class="p">:</span>
            <span class="n">samples_new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resample_antialiasing</span><span class="p">(</span>
                <span class="n">samples_new</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">sampling_rate_old</span> <span class="o">/</span> <span class="n">sampling_rate_new</span>
            <span class="p">)</span>

        <span class="c1"># Create a new SignalBlock object from the resampled samples and return it as result</span>
        <span class="n">off_new</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">*</span> <span class="n">sampling_rate_new</span> <span class="o">/</span> <span class="n">sampling_rate_old</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">SignalBlock</span><span class="p">(</span><span class="n">samples_new</span><span class="p">,</span> <span class="n">off_new</span><span class="p">)</span></div>


<div class="viewcode-block" id="SignalBlock.append_samples">
<a class="viewcode-back" href="../../../api/core/signal.html#hermespy.core.signal_model.SignalBlock.append_samples">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">append_samples</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SignalBlock</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Append samples to this signal block. Creates a new instance.&quot;&quot;&quot;</span>

        <span class="c1"># Validate value</span>
        <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_streams</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Shape mismatch&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">SignalBlock</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></div>


    <span class="nd">@staticmethod</span>
    <span class="nd">@jit</span><span class="p">(</span><span class="n">nopython</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_mix</span><span class="p">(</span>
        <span class="n">target_samples</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">stream_indices</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">added_samples</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">sampling_rate</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">frequency_distance</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Internal subroutine to mix two sets of signal model samples.</span>

<span class="sd">        Args:</span>
<span class="sd">            target_samples:</span>
<span class="sd">                Target samples onto which `added_samples` will be mixed.</span>

<span class="sd">            added_samples:</span>
<span class="sd">                Samples to be mixed onto `target_samples`.</span>

<span class="sd">            sampling_rate:</span>
<span class="sd">                Sampling rate in Hz, which both `target_samples` and `added_samples` must share.</span>

<span class="sd">            frequency_distance:</span>
<span class="sd">                Distance between the carrier frequencies of `target_samples` and `added_samples` in Hz.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">num_added_samples</span> <span class="o">=</span> <span class="n">added_samples</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1"># ToDo: Reminder, mixing like this currently does not account for possible delays.</span>
        <span class="n">mix_sinusoid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
            <span class="mi">2</span><span class="n">j</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_added_samples</span><span class="p">)</span> <span class="o">*</span> <span class="n">frequency_distance</span> <span class="o">/</span> <span class="n">sampling_rate</span>
        <span class="p">)</span>

        <span class="n">target_samples</span><span class="p">[</span><span class="n">stream_indices</span><span class="p">,</span> <span class="p">:</span><span class="n">num_added_samples</span><span class="p">]</span> <span class="o">+=</span> <span class="n">added_samples</span> <span class="o">*</span> <span class="n">mix_sinusoid</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:]</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_resample_antialiasing</span><span class="p">(</span><span class="n">samples</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">N</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Wn</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Internal subroutine for resampled method. Applies Butterworth filter to the given samples.</span>

<span class="sd">        Args:</span>
<span class="sd">            samples: Samples to apply AA to.</span>
<span class="sd">            N: The first two parameters of scipy.signal.butter.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">aliasing_filter</span> <span class="o">=</span> <span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">Wn</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="s2">&quot;low&quot;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s2">&quot;sos&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">sosfilt</span><span class="p">(</span><span class="n">aliasing_filter</span><span class="p">,</span> <span class="n">samples</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="nd">@jit</span><span class="p">(</span><span class="n">nopython</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_resample</span><span class="p">(</span>
        <span class="n">signal</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">input_sampling_rate</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">output_sampling_rate</span><span class="p">:</span> <span class="nb">float</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Internal subroutine to resample a given set of samples to a new sampling rate.</span>

<span class="sd">        Uses sinc-interpolation, therefore `signal` is assumed to be band-limited.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            signal:</span>
<span class="sd">                TxM matrix of T signal-streams to be resampled, each containing M time-discrete samples.</span>

<span class="sd">            input_sampling_rate:</span>
<span class="sd">                Rate at which `signal` is sampled in Hz.</span>

<span class="sd">            output_sampling_rate:</span>
<span class="sd">                Rate at which the resampled signal will be sampled in Hz.</span>

<span class="sd">        Returns:</span>
<span class="sd">            MxT&#39; matrix of M resampled signal streams.</span>
<span class="sd">            The number of samples T&#39; depends on the sampling rate relations, e.i.</span>
<span class="sd">            T&#39; = T * output_sampling_rate / input_sampling_rate .</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">num_streams</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">num_input_samples</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">num_output_samples</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">num_input_samples</span> <span class="o">*</span> <span class="n">output_sampling_rate</span> <span class="o">/</span> <span class="n">input_sampling_rate</span><span class="p">)</span>

        <span class="n">input_timestamps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_input_samples</span><span class="p">)</span> <span class="o">/</span> <span class="n">input_sampling_rate</span>
        <span class="n">output_timestamps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_output_samples</span><span class="p">)</span> <span class="o">/</span> <span class="n">output_sampling_rate</span>

        <span class="n">output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">num_streams</span><span class="p">,</span> <span class="n">num_output_samples</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">complex128</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">output_idx</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_output_samples</span><span class="p">):</span>
            <span class="c1"># Sinc interpolation weights for single output sample</span>
            <span class="n">interpolation_weights</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">sinc</span><span class="p">((</span><span class="n">input_timestamps</span> <span class="o">-</span> <span class="n">output_timestamps</span><span class="p">[</span><span class="n">output_idx</span><span class="p">])</span> <span class="o">*</span> <span class="n">input_sampling_rate</span><span class="p">)</span>
                <span class="o">+</span> <span class="mi">0</span><span class="n">j</span>
            <span class="p">)</span>

            <span class="c1"># Resample all streams simultaneously</span>
            <span class="n">output</span><span class="p">[:,</span> <span class="n">output_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">@</span> <span class="n">interpolation_weights</span>

        <span class="k">return</span> <span class="n">output</span>

<div class="viewcode-block" id="SignalBlock.serialize">
<a class="viewcode-back" href="../../../api/core/signal.html#hermespy.core.signal_model.SignalBlock.serialize">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">process</span><span class="p">:</span> <span class="n">SerializationProcess</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">process</span><span class="o">.</span><span class="n">serialize_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;samples&quot;</span><span class="p">)</span>
        <span class="n">process</span><span class="o">.</span><span class="n">serialize_integer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="s2">&quot;offset&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="SignalBlock.Deserialize">
<a class="viewcode-back" href="../../../api/core/signal.html#hermespy.core.signal_model.SignalBlock.Deserialize">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">Deserialize</span><span class="p">(</span><span class="bp">cls</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">SignalBlock</span><span class="p">],</span> <span class="n">process</span><span class="p">:</span> <span class="n">DeserializationProcess</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SignalBlock</span><span class="p">:</span>
        <span class="n">samples</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">deserialize_array</span><span class="p">(</span><span class="s2">&quot;samples&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">deserialize_integer</span><span class="p">(</span><span class="s2">&quot;offset&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="Signal">
<a class="viewcode-back" href="../../../api/core/signal.html#hermespy.core.signal_model.Signal">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Signal</span><span class="p">(</span><span class="n">ABC</span><span class="p">,</span> <span class="n">Serializable</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Abstract base class for all signal models in HermesPy.&quot;&quot;&quot;</span>

    <span class="n">filter_order</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># Order of the filters applied during superimposition</span>
    <span class="n">_blocks</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">SignalBlock</span><span class="p">]</span>
    <span class="n">_sampling_rate</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">_carrier_frequency</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">_noise_power</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">_samples_visualization</span><span class="p">:</span> <span class="n">_SamplesVisualization</span>
    <span class="n">_eye_visualization</span><span class="p">:</span> <span class="n">_EyeVisualization</span>
    <span class="n">delay</span><span class="p">:</span> <span class="nb">float</span>

    <span class="n">_num_streams</span><span class="p">:</span> <span class="nb">int</span>

<div class="viewcode-block" id="Signal.from_ndarray">
<a class="viewcode-back" href="../../../api/core/signal.html#hermespy.core.signal_model.Signal.from_ndarray">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_ndarray</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">samples</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new signal using parameters from this signal.</span>
<span class="sd">        Equivalent to `create(samples, \*\*self.kwargs)`.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Create</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Signal.Create">
<a class="viewcode-back" href="../../../api/core/signal.html#hermespy.core.signal_model.Signal.Create">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">Create</span><span class="p">(</span>
        <span class="n">samples</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
        <span class="n">sampling_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="n">carrier_frequency</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">noise_power</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">delay</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">offsets</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Signal</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a signal model instance given signal samples.</span>

<span class="sd">        Subclasses of Signal should reroute the given arguments to init and return the result.</span>

<span class="sd">        Args:</span>

<span class="sd">            samples:</span>
<span class="sd">                Single or a sequence of 2D matricies with shapes MxT_i, where M - number of streams, T_i - number of samples in the matrix i.</span>
<span class="sd">                Note that M for each entry of the sequence must be the same.</span>
<span class="sd">                SignalBlock and Sequence[SignalBlock] can also be passed here.</span>

<span class="sd">            sampling_rate:</span>
<span class="sd">                Sampling rate of the signal in Hz.</span>

<span class="sd">            offsets:</span>
<span class="sd">                Integer offsets of the samples if given in a sequence.</span>
<span class="sd">                Ignored if samples is not a Sequence of np.ndarray.</span>
<span class="sd">                len(offsets) must be equal to len(samples).</span>
<span class="sd">                Offset number i must be greater then offset i-1 + samples[i-1].shape[1].</span>

<span class="sd">        Returns:</span>
<span class="sd">            SparseSignal if samples argument is a list of ndarrays. DenseSignal otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">SparseSignal</span><span class="p">(</span>
                <span class="n">samples</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="p">,</span> <span class="n">carrier_frequency</span><span class="p">,</span> <span class="n">noise_power</span><span class="p">,</span> <span class="n">delay</span><span class="p">,</span> <span class="n">offsets</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">DenseSignal</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="p">,</span> <span class="n">carrier_frequency</span><span class="p">,</span> <span class="n">noise_power</span><span class="p">,</span> <span class="n">delay</span><span class="p">,</span> <span class="n">offsets</span><span class="p">)</span></div>


    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">yield from</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get number of blocks in the signal model.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_get_blocks_union</span><span class="p">(</span>
        <span class="n">bs1</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">SignalBlock</span><span class="p">],</span> <span class="n">bs2</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">SignalBlock</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate new blocks offsets and ends for a union of 2 different signals.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A tuple of two numpy arrays:</span>
<span class="sd">            1. A list of new blocks offsets</span>
<span class="sd">            2. a list of new blocks ends</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Get nonzero column indices for both signals</span>
        <span class="n">nonzero_bs1</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">offset</span> <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">num_samples</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">bs1</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bs1</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span>
            <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="nb">int</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">nonzero_bs2</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">offset</span> <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">num_samples</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">bs2</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bs2</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span>
            <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="nb">int</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="c1"># Join them (calculate a union)</span>
        <span class="n">nz_cols_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">union1d</span><span class="p">(</span><span class="n">nonzero_bs1</span><span class="p">,</span> <span class="n">nonzero_bs2</span><span class="p">)</span>

        <span class="c1"># Transform column indices to new block starts and stops</span>
        <span class="c1"># Find block starts in the nz_cols_idx</span>
        <span class="n">b_offs_idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ediff1d</span><span class="p">(</span><span class="n">nz_cols_idx</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># b_offs_idx is not finished yet, but can be used to calculate block stops here</span>
        <span class="n">b_stops</span> <span class="o">=</span> <span class="n">nz_cols_idx</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b_offs_idx</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="c1"># Now finish off the blocks offset indices array</span>
        <span class="n">b_offs_idx</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">b_offs_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([[</span><span class="mi">0</span><span class="p">],</span> <span class="n">b_offs_idx</span><span class="p">])</span>
        <span class="c1"># Find blocks offsets</span>
        <span class="n">b_offs</span> <span class="o">=</span> <span class="n">nz_cols_idx</span><span class="p">[</span><span class="n">b_offs_idx</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">b_offs</span><span class="p">,</span> <span class="n">b_stops</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">__parse_slice</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">slice</span><span class="p">,</span> <span class="n">dim_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Helper function for _parse_validate_itemkey.</span>
<span class="sd">        Given a slice and a size of the sliced dimension,</span>
<span class="sd">        returns non-negative values for start, stop and step of the slice.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Resolve None</span>
        <span class="n">s0</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">start</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">s</span><span class="o">.</span><span class="n">start</span>
        <span class="n">s1</span> <span class="o">=</span> <span class="n">dim_size</span> <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">stop</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">s</span><span class="o">.</span><span class="n">stop</span>
        <span class="n">s2</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">step</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">s</span><span class="o">.</span><span class="n">step</span>
        <span class="c1"># Resolve negative</span>
        <span class="n">s0</span> <span class="o">=</span> <span class="n">s0</span> <span class="k">if</span> <span class="n">s0</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">s0</span> <span class="o">%</span> <span class="n">dim_size</span>
        <span class="n">s1</span> <span class="o">=</span> <span class="n">s1</span> <span class="k">if</span> <span class="n">s1</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">s1</span> <span class="o">%</span> <span class="n">dim_size</span>
        <span class="k">return</span> <span class="n">s0</span><span class="p">,</span> <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_parse_validate_itemkey</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Any</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse and validate key in __getitem__ and __setitem__.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError if key is not</span>
<span class="sd">                an int,</span>
<span class="sd">                a slice,</span>
<span class="sd">                a tuple of (int, int), (slice, slice), (int, slice) or (slice, int),</span>
<span class="sd">                a boolean mask.</span>
<span class="sd">            IndexError if the key is out of bounds of the signal model.</span>

<span class="sd">        Returns:</span>
<span class="sd">            s00: streams start</span>
<span class="sd">            s01: streams stop</span>
<span class="sd">            s02: streams step</span>
<span class="sd">            s10: samples start</span>
<span class="sd">            s11: samples stop</span>
<span class="sd">            s12: samples step</span>
<span class="sd">            isboolmask: True if key is a boolean mask, False otherwise.</span>
<span class="sd">            should_flatten_streams: True if numpy&#39;s getitem would flatten the streams (1) dimension with this key</span>
<span class="sd">            should_flatten_samples: True if numpy&#39;s getitem would flatten the samples (2) dimension with this key</span>

<span class="sd">            Note that if isboolmask is True, then all s?? take the following values:</span>
<span class="sd">            (0, self.num_streams, 1, 0, self.num_samples, 1).</span>

<span class="sd">            Note that if the key references any dimension with an integer index,</span>
<span class="sd">            then the corresponding result start will be the index, and stop is start+1.</span>
<span class="sd">            For example, if key is 1, then only stream 1 is need. Then s00 is 1 and s01 is 2.</span>
<span class="sd">            Numpy getitem of [1] and [1:2] differ in dimensions. Flattening of the second variant should be considered.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">self_num_streams</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_streams</span>
        <span class="n">self_num_samples</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_samples</span>
        <span class="n">isboolmask</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">should_flatten_streams</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">should_flatten_samples</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Key is a tuple of two</span>
        <span class="c1"># ======================================================================</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="c1"># Validate streams key</span>
            <span class="n">streams_key_is_slice</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">slice</span><span class="p">)</span>
            <span class="n">samples_key_is_slice</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">slice</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">streams_key_is_slice</span><span class="p">:</span>
                <span class="n">s00</span><span class="p">,</span> <span class="n">s01</span><span class="p">,</span> <span class="n">s02</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__parse_slice</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">self_num_streams</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">s00</span> <span class="o">&gt;=</span> <span class="n">s01</span> <span class="ow">and</span> <span class="n">self_num_streams</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Streams slice start must be lower then stop (</span><span class="si">{</span><span class="n">s00</span><span class="si">}</span><span class="s2"> &gt;= </span><span class="si">{</span><span class="n">s01</span><span class="si">}</span><span class="s2">)&quot;</span>
                    <span class="p">)</span>
            <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">self_num_streams</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Streams index is out of bounds (number of streams is </span><span class="si">{</span><span class="n">self_num_streams</span><span class="si">}</span><span class="s2">, but stream </span><span class="si">{</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> was requested)&quot;</span>
                    <span class="p">)</span>
                <span class="n">s00</span> <span class="o">=</span> <span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">%</span> <span class="n">self_num_streams</span>
                <span class="n">s01</span> <span class="o">=</span> <span class="n">s00</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">s02</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">should_flatten_streams</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Expected to get streams index as an integer or a slice, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

            <span class="c1"># Parse samples key (key[1])</span>
            <span class="c1"># Samples are indexed with an int</span>
            <span class="k">if</span> <span class="n">samples_key_is_slice</span><span class="p">:</span>
                <span class="n">s10</span><span class="p">,</span> <span class="n">s11</span><span class="p">,</span> <span class="n">s12</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__parse_slice</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">self_num_samples</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">self_num_samples</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Samples index is out of bounds (</span><span class="si">{</span><span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> &gt; </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
                <span class="n">s10</span> <span class="o">=</span> <span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">%</span> <span class="n">self_num_samples</span>
                <span class="n">s11</span> <span class="o">=</span> <span class="n">s10</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">s12</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">should_flatten_samples</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Samples key is ofan unsupported type (</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="p">(</span>
                <span class="n">s00</span><span class="p">,</span>
                <span class="n">s01</span><span class="p">,</span>
                <span class="n">s02</span><span class="p">,</span>
                <span class="n">s10</span><span class="p">,</span>
                <span class="n">s11</span><span class="p">,</span>
                <span class="n">s12</span><span class="p">,</span>
                <span class="kc">False</span><span class="p">,</span>
                <span class="n">should_flatten_streams</span><span class="p">,</span>
                <span class="n">should_flatten_samples</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="c1"># ======================================================================</span>
        <span class="c1"># done Key is a tuple of two</span>

        <span class="c1"># Samples key is considered to be not given from now on</span>
        <span class="n">s10</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">s11</span> <span class="o">=</span> <span class="n">self_num_samples</span>
        <span class="n">s12</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="c1"># Parse streams key</span>
        <span class="c1"># Key is a slice over streams</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
            <span class="n">s00</span><span class="p">,</span> <span class="n">s01</span><span class="p">,</span> <span class="n">s02</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__parse_slice</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">self_num_streams</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">s00</span> <span class="o">&gt;=</span> <span class="n">s01</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Streams slice start must be lower then stop (</span><span class="si">{</span><span class="n">s00</span><span class="si">}</span><span class="s2"> &gt;= </span><span class="si">{</span><span class="n">s01</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="c1"># Key is an integer index over streams</span>
        <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">key</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">key</span> <span class="o">&gt;=</span> <span class="n">self_num_streams</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Streams index is out of bounds (number of streams is </span><span class="si">{</span><span class="n">self_num_streams</span><span class="si">}</span><span class="s2">, but stream </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> was requested)&quot;</span>
                <span class="p">)</span>
            <span class="n">s00</span> <span class="o">=</span> <span class="n">key</span> <span class="o">%</span> <span class="n">self_num_streams</span>
            <span class="n">s01</span> <span class="o">=</span> <span class="n">s00</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">s02</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">should_flatten_streams</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># Key is a boolean mask or something unsupported</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="n">self_num_streams</span><span class="p">,</span> <span class="n">self_num_samples</span><span class="p">):</span>
                    <span class="n">isboolmask</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="n">s00</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">s01</span> <span class="o">=</span> <span class="n">self_num_streams</span>
                    <span class="n">s02</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unsupported key type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="n">s00</span><span class="p">,</span>
            <span class="n">s01</span><span class="p">,</span>
            <span class="n">s02</span><span class="p">,</span>
            <span class="n">s10</span><span class="p">,</span>
            <span class="n">s11</span><span class="p">,</span>
            <span class="n">s12</span><span class="p">,</span>
            <span class="n">isboolmask</span><span class="p">,</span>
            <span class="n">should_flatten_streams</span><span class="p">,</span>
            <span class="n">should_flatten_samples</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_find_affected_blocks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s10</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">s11</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Find indices of blocks that are affected by the given samples slice.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            s10: Start of the samples slice.</span>
<span class="sd">            s11: Stop of the samples slice.</span>

<span class="sd">        Return:</span>
<span class="sd">            b_start, b_stop:</span>
<span class="sd">                Indices of the first and the last affected blocks.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Done with a binary search algotrithm.</span>

        <span class="c1"># Starting block</span>
        <span class="n">L</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">R</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">b_start</span> <span class="o">=</span> <span class="n">L</span>
        <span class="k">while</span> <span class="n">L</span> <span class="o">&lt;</span> <span class="n">R</span><span class="p">:</span>
            <span class="n">b_start</span> <span class="o">=</span> <span class="o">-</span><span class="p">((</span><span class="n">R</span> <span class="o">+</span> <span class="n">L</span><span class="p">)</span> <span class="o">//</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># upside-down floor division</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">[</span><span class="n">b_start</span><span class="p">]</span><span class="o">.</span><span class="n">offset</span> <span class="o">&gt;</span> <span class="n">s10</span><span class="p">:</span>
                <span class="n">R</span> <span class="o">=</span> <span class="n">b_start</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">L</span> <span class="o">=</span> <span class="n">b_start</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">[</span><span class="n">b_start</span><span class="p">]</span><span class="o">.</span><span class="n">offset</span> <span class="o">&gt;</span> <span class="n">s10</span> <span class="ow">and</span> <span class="n">b_start</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">b_start</span> <span class="o">-=</span> <span class="mi">1</span>

        <span class="c1"># Stopping block</span>
        <span class="n">L</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">R</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">b_stop</span> <span class="o">=</span> <span class="n">R</span>
        <span class="k">while</span> <span class="n">L</span> <span class="o">&lt;</span> <span class="n">R</span><span class="p">:</span>
            <span class="n">b_stop</span> <span class="o">=</span> <span class="p">(</span><span class="n">R</span> <span class="o">+</span> <span class="n">L</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">[</span><span class="n">b_stop</span><span class="p">]</span><span class="o">.</span><span class="n">end</span> <span class="o">&lt;</span> <span class="n">s11</span><span class="p">:</span>
                <span class="n">L</span> <span class="o">=</span> <span class="n">b_stop</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">R</span> <span class="o">=</span> <span class="n">b_stop</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">[</span><span class="n">b_stop</span><span class="p">]</span><span class="o">.</span><span class="n">end</span> <span class="o">&lt;</span> <span class="n">s11</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">b_stop</span><span class="p">:</span>
            <span class="n">b_stop</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="n">b_start</span><span class="p">,</span> <span class="n">b_stop</span>

<div class="viewcode-block" id="Signal.getitem">
<a class="viewcode-back" href="../../../api/core/signal.html#hermespy.core.signal_model.Signal.getitem">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">getitem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">unflatten</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get specified samples.</span>
<span class="sd">        Works like np.ndarray.__getitem__, but de-sparsifies the signal.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            key:</span>
<span class="sd">                an int, a slice,</span>
<span class="sd">                a tuple (int, int), (int, slice), (slice, int), (slice, slice)</span>
<span class="sd">                or a boolean mask.</span>
<span class="sd">                Defaults to slice(None, None) (same as [:, :])</span>
<span class="sd">            unflatten:</span>
<span class="sd">                Set to True to ensure the result ndim to be 2 even if only one stream is selected.</span>
<span class="sd">                Set to False to allow the numpy-like degenerate dimensions reduction.</span>

<span class="sd">        Examples:</span>
<span class="sd">            getitem(slice(None, None)):</span>
<span class="sd">                Select all samples from the signal.</span>
<span class="sd">                Warning: can cause memory overflow if used with a sparse signal.</span>
<span class="sd">            getitem(0):</span>
<span class="sd">                Select and de-sparsify the first stream.</span>
<span class="sd">                Result shape is (1, num_samples)</span>
<span class="sd">            getitem(0, False):</span>
<span class="sd">                Same, but allow the numpy flattening.</span>
<span class="sd">                Result shape is (num_samples,)</span>
<span class="sd">            getitem((slice(None, 2), slice(50, 100))):</span>
<span class="sd">                Select streams 0, 1 and samples 50-99.</span>
<span class="sd">                Same as samples_matrix[:2, 50:100]</span>

<span class="sd">        Returns: Array with ndim 2 or less and  dtype dtype np.complex128&quot;&quot;&quot;</span>

        <span class="n">s00</span><span class="p">,</span> <span class="n">s01</span><span class="p">,</span> <span class="n">s02</span><span class="p">,</span> <span class="n">s10</span><span class="p">,</span> <span class="n">s11</span><span class="p">,</span> <span class="n">s12</span><span class="p">,</span> <span class="n">isboolmask</span><span class="p">,</span> <span class="n">should_flatten_streams</span><span class="p">,</span> <span class="n">should_flatten_samples</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parse_validate_itemkey</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">num_streams</span> <span class="o">=</span> <span class="o">-</span><span class="p">((</span><span class="n">s01</span> <span class="o">-</span> <span class="n">s00</span><span class="p">)</span> <span class="o">//</span> <span class="o">-</span><span class="n">s02</span><span class="p">)</span>
        <span class="n">num_samples</span> <span class="o">=</span> <span class="o">-</span><span class="p">((</span><span class="n">s11</span> <span class="o">-</span> <span class="n">s10</span><span class="p">)</span> <span class="o">//</span> <span class="o">-</span><span class="n">s12</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_samples</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_streams</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># if this signal is empty</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_streams</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>

        <span class="c1"># If key is a boolean mask</span>
        <span class="k">if</span> <span class="n">isboolmask</span><span class="p">:</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_dense</span><span class="p">()</span><span class="o">.</span><span class="n">_blocks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)[</span><span class="n">mask</span><span class="p">]</span>

        <span class="c1"># Find blocks hit by the samples slice</span>
        <span class="n">b_start</span><span class="p">,</span> <span class="n">b_stop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_affected_blocks</span><span class="p">(</span><span class="n">s10</span><span class="p">,</span> <span class="n">s11</span><span class="p">)</span>

        <span class="c1"># Slicing is done inside one or no blocks</span>
        <span class="k">if</span> <span class="n">b_start</span> <span class="o">==</span> <span class="n">b_stop</span><span class="p">:</span>
            <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">[</span><span class="n">b_stop</span><span class="p">]</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_streams</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>
            <span class="c1"># if slicing is done inside only one block entirely</span>
            <span class="k">if</span> <span class="n">s10</span> <span class="o">&gt;=</span> <span class="n">b</span><span class="o">.</span><span class="n">offset</span><span class="p">:</span>
                <span class="n">b_sliced</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">s00</span><span class="p">:</span><span class="n">s01</span><span class="p">:</span><span class="n">s02</span><span class="p">,</span> <span class="n">s10</span> <span class="o">-</span> <span class="n">b</span><span class="o">.</span><span class="n">offset</span> <span class="p">:</span> <span class="n">s11</span> <span class="o">-</span> <span class="n">b</span><span class="o">.</span><span class="n">offset</span> <span class="p">:</span> <span class="n">s12</span><span class="p">]</span>
                <span class="n">res</span><span class="p">[:,</span> <span class="p">:</span> <span class="n">b_sliced</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">b_sliced</span>
            <span class="c1"># else if the slice starts in a zero gap and ends somewhere inside the block</span>
            <span class="c1">#               v  slice  v</span>
            <span class="c1"># xxxxxxxxxxxx00000xxxxxxxxxxxxxxxx</span>
            <span class="c1"># ^b previous^^gap^^b_start/b_stop^</span>
            <span class="k">elif</span> <span class="n">s11</span> <span class="o">&gt;</span> <span class="n">b</span><span class="o">.</span><span class="n">offset</span><span class="p">:</span>
                <span class="n">res</span><span class="p">[:,</span> <span class="n">b</span><span class="o">.</span><span class="n">offset</span> <span class="o">-</span> <span class="n">s10</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">s00</span><span class="p">:</span><span class="n">s01</span><span class="p">:</span><span class="n">s02</span><span class="p">,</span> <span class="p">:]</span>
            <span class="c1"># Apply numpy-like flattening</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">unflatten</span> <span class="ow">and</span> <span class="p">(</span><span class="n">should_flatten_streams</span> <span class="ow">or</span> <span class="n">should_flatten_samples</span><span class="p">):</span>
                <span class="n">res</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">res</span>

        <span class="c1"># assemble the result</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">num_streams</span><span class="p">,</span> <span class="n">s11</span> <span class="o">-</span> <span class="n">s10</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>
        <span class="c1"># the first block</span>
        <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">[</span><span class="n">b_start</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">s10</span> <span class="o">&lt;</span> <span class="n">b</span><span class="o">.</span><span class="n">end</span><span class="p">:</span>
            <span class="n">w_size</span> <span class="o">=</span> <span class="n">s10</span> <span class="o">-</span> <span class="n">b</span><span class="o">.</span><span class="n">offset</span>
            <span class="k">if</span> <span class="n">w_size</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># slice starts before the first window</span>
                <span class="n">res</span><span class="p">[:,</span> <span class="o">-</span><span class="n">w_size</span> <span class="p">:</span> <span class="n">b</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">w_size</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[:,</span> <span class="p">:]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">b_sliced</span> <span class="o">=</span> <span class="n">b</span><span class="p">[:,</span> <span class="o">-</span><span class="n">w_size</span><span class="p">:]</span>
                <span class="n">res</span><span class="p">[:,</span> <span class="p">:</span> <span class="n">b_sliced</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">b_sliced</span>
        <span class="c1"># blocks between the first and the last ones</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">b_start</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">b_stop</span><span class="p">):</span>
            <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">w_start</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">offset</span> <span class="o">-</span> <span class="n">s10</span>
            <span class="n">w_end</span> <span class="o">=</span> <span class="n">w_start</span> <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">res</span><span class="p">[:,</span> <span class="n">w_start</span><span class="p">:</span><span class="n">w_end</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[:,</span> <span class="p">:]</span>
        <span class="c1"># the last block</span>
        <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">[</span><span class="n">b_stop</span><span class="p">]</span>
        <span class="n">w_start</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">s11</span> <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">offset</span>
        <span class="n">w_stop</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">w_start</span> <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">res</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">res</span><span class="p">[:,</span> <span class="n">w_start</span><span class="p">:</span><span class="n">w_stop</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[:,</span> <span class="p">:</span> <span class="n">w_stop</span> <span class="o">-</span> <span class="n">w_start</span><span class="p">]</span>

        <span class="c1"># Apply stream slicing and the samples step.</span>

        <span class="c1"># The following check is required for proper handling</span>
        <span class="c1"># of the streams key that looks like slice(None, None, -*something*).</span>
        <span class="c1"># In this case, (s00, s01, s02) will be (0, num_streams, -*something*).</span>
        <span class="c1"># Slicing by [0:num_streams:-*something*] and [::-*something*]</span>
        <span class="c1"># yield different results. We would like to get the second one.</span>

        <span class="n">is_streams_step_reversing</span> <span class="o">=</span> <span class="p">(</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">slice</span><span class="p">)</span> <span class="ow">and</span> <span class="n">key</span><span class="o">.</span><span class="n">start</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">key</span><span class="o">.</span><span class="n">stop</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="p">)</span>
        <span class="n">is_streams_step_reversing</span> <span class="o">|=</span> <span class="p">(</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
            <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">slice</span><span class="p">)</span>
            <span class="ow">and</span> <span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">start</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stop</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">is_streams_step_reversing</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">res</span><span class="p">[::</span><span class="n">s02</span><span class="p">,</span> <span class="p">::</span><span class="n">s12</span><span class="p">]</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="n">s00</span><span class="p">:</span><span class="n">s01</span><span class="p">:</span><span class="n">s02</span><span class="p">,</span> <span class="p">::</span><span class="n">s12</span><span class="p">]</span>

        <span class="c1"># Apply numpy-like flattening</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">unflatten</span> <span class="ow">and</span> <span class="p">(</span><span class="n">should_flatten_streams</span> <span class="ow">or</span> <span class="n">should_flatten_samples</span><span class="p">):</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">res</span></div>


<div class="viewcode-block" id="Signal.getstreams">
<a class="viewcode-back" href="../../../api/core/signal.html#hermespy.core.signal_model.Signal.getstreams">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">getstreams</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">streams_key</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">slice</span> <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Signal</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new signal like this, but with only the selected streams.</span>

<span class="sd">        Args:</span>
<span class="sd">            streams_key:</span>
<span class="sd">                Stream indices to select.</span>

<span class="sd">        Return: Signal of the same implementation as the caller, containing only the selected streams</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">blocks</span> <span class="o">=</span> <span class="p">[</span><span class="n">b</span><span class="p">[</span><span class="n">streams_key</span><span class="p">]</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Create</span><span class="p">(</span><span class="n">blocks</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span></div>


    <span class="k">def</span><span class="w"> </span><span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set an np.ndarray of samples into the model.&quot;&quot;&quot;</span>

        <span class="o">...</span>  <span class="c1"># pragma: no cover</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns:</span>
<span class="sd">        {&quot;sampling_rate&quot;: self.sampling_rate,</span>
<span class="sd">        &quot;carrier_frequency&quot;: self.carrier_frequency,</span>
<span class="sd">        &quot;delay&quot;: self.delay,</span>
<span class="sd">        &quot;noise_power&quot;: self.noise_power}&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;sampling_rate&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span>
            <span class="s2">&quot;carrier_frequency&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">carrier_frequency</span><span class="p">,</span>
            <span class="s2">&quot;delay&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">delay</span><span class="p">,</span>
            <span class="s2">&quot;noise_power&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise_power</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_validate_samples_offsets</span><span class="p">(</span>
        <span class="n">samples</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">offsets</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Raises ValueError if any of the following fails:</span>
<span class="sd">            1. samples is a 2D matrix or a Sequence of 2D matrices with similar number of streams</span>
<span class="sd">            (e.g. samples[i].shape[0] == samples[i+1].shape[0]).</span>
<span class="sd">            2. offsets (if given) has the same length as samples argument.</span>
<span class="sd">            3. samples windows with given offsets do not overlap.</span>

<span class="sd">        Returns:</span>
<span class="sd">            samples:</span>
<span class="sd">                A python list if 2D matrices.</span>
<span class="sd">            offsets:</span>
<span class="sd">                A list of valid offsets.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># np.ndarray was given</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">samples</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># vector or np.ndarray or objects</span>
                <span class="k">if</span> <span class="n">samples</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="nb">object</span><span class="p">:</span>  <span class="c1"># vector</span>
                    <span class="n">samples</span> <span class="o">=</span> <span class="p">[</span><span class="n">samples</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">samples</span><span class="o">.</span><span class="n">size</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">samples</span> <span class="o">=</span> <span class="n">samples</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>  <span class="c1"># pragma: no cover</span>
            <span class="k">elif</span> <span class="n">samples</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># 2D matrix</span>
                <span class="n">samples</span> <span class="o">=</span> <span class="p">[</span><span class="n">samples</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)]</span>
            <span class="k">elif</span> <span class="n">samples</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>  <span class="c1"># Tensor of 2D matrices</span>
                <span class="n">samples</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># Higher dim tensor</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;ndarrays of more then 3 dims are not acceptable (</span><span class="si">{</span><span class="n">samples</span><span class="o">.</span><span class="n">ndim</span><span class="si">}</span><span class="s2"> were given)&quot;</span>
                <span class="p">)</span>

        <span class="c1"># samples is Sequence[np.ndarray] from now on</span>

        <span class="c1"># Check if samples list is empty</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)],</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="c1"># Validate and adjust samples</span>
        <span class="n">num_streams</span> <span class="o">=</span> <span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">)):</span>
            <span class="c1"># dtype</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">iscomplexobj</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
                <span class="n">samples</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">samples</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
            <span class="c1"># ndim</span>
            <span class="k">if</span> <span class="n">samples</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">samples</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">samples</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">samples</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>  <span class="c1"># type: ignore</span>
            <span class="k">elif</span> <span class="n">samples</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;ndarrays of more then 3 dims are not acceptable (One of samples entries has </span><span class="si">{</span><span class="n">samples</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">ndim</span><span class="si">}</span><span class="s2"> ndim)&quot;</span>
                <span class="p">)</span>
            <span class="c1"># num_streams</span>
            <span class="k">if</span> <span class="n">samples</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">num_streams</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;At least one if the samples blocks contains different number of streams (samples[0].shape[0] is </span><span class="si">{</span><span class="n">num_streams</span><span class="si">}</span><span class="s2">, but samples[</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">].shape[0] is </span><span class="si">{</span><span class="n">samples</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span>
                <span class="p">)</span>

        <span class="c1"># Validate offsets length</span>
        <span class="k">if</span> <span class="n">offsets</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">offsets</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;samples and offsets legthes do not match (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">offsets</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Resolve offsets from samples, if offsets argument is None</span>
        <span class="n">offsets_</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">offsets</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">offsets_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">),),</span> <span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">offsets_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;_offset&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">)):</span>
                <span class="n">offsets_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span>
                    <span class="n">samples</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s2">&quot;_offset&quot;</span><span class="p">,</span> <span class="n">offsets_</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">samples</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">offsets_</span> <span class="o">=</span> <span class="n">offsets</span>

        <span class="c1"># Validate the offsets</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">)):</span>
            <span class="n">gap_start</span> <span class="o">=</span> <span class="n">offsets_</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">samples</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">offsets_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">gap_start</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;One of the blocks contains incorrect offset in this sequence (previous block ends on </span><span class="si">{</span><span class="n">gap_start</span><span class="si">}</span><span class="s2">, this block&#39;s offset is </span><span class="si">{</span><span class="n">offsets_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span>
                <span class="p">)</span>

        <span class="k">return</span> <span class="n">samples</span><span class="p">,</span> <span class="n">offsets_</span>  <span class="c1"># type: ignore</span>

<div class="viewcode-block" id="Signal.set_samples">
<a class="viewcode-back" href="../../../api/core/signal.html#hermespy.core.signal_model.Signal.set_samples">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_samples</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">samples</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">SignalBlock</span><span class="p">],</span>
        <span class="n">offsets</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets given samples into this dense signal model.</span>
<span class="sd">        Validates given samples and optional offsets, writes them into _blocks attribute and resambles, if needed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">samples</span><span class="p">,</span> <span class="n">offsets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_samples_offsets</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">offsets</span><span class="p">)</span>

        <span class="c1"># _blocks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">b</span><span class="p">,</span> <span class="n">o</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">offsets</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SignalBlock</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">o</span><span class="p">))</span>

        <span class="c1"># num_streams</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_num_streams</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>


<div class="viewcode-block" id="Signal.Empty">
<a class="viewcode-back" href="../../../api/core/signal.html#hermespy.core.signal_model.Signal.Empty">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">Empty</span><span class="p">(</span><span class="n">sampling_rate</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">num_streams</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Signal</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates an empty signal model instance. Initializes it with the given arguments.</span>
<span class="sd">        If both num_streams and num_samples are not 0, then initilizes samples with np.empty.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">Signal</span><span class="o">.</span><span class="n">Create</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">num_streams</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">)),</span> <span class="n">sampling_rate</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">num_streams</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The number of streams within this signal model.</span>

<span class="sd">        Returns: The number of streams.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_streams</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">num_samples</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The number of samples within this signal model.</span>

<span class="sd">        Returns: The number of samples.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">end</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Two dimensional tuple of shape :math:`M \\times N`.</span>

<span class="sd">        :math:`M` is the number of streams and :math:`N` is the number of samples.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_streams</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_samples</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">sampling_rate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The rate at which the modeled signal was sampled in Hz.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sampling_rate</span>

    <span class="nd">@sampling_rate</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">sampling_rate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Modify the rate at which the modeled signal was sampled.</span>

<span class="sd">        Args:</span>
<span class="sd">            value: The sampling rate in Hz.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If `value` is smaller or equal to zero.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The sampling rate of modeled signals must be greater than zero&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_sampling_rate</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">b</span><span class="o">.</span><span class="n">_sampling_rate</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">carrier_frequency</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The center frequency of the modeled signal in the radio-frequency transmit band in Hz.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_carrier_frequency</span>

    <span class="nd">@carrier_frequency</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">carrier_frequency</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Modify the center frequency of the modeled signal in the radio-frequency transmit band.</span>

<span class="sd">        Args:</span>
<span class="sd">            value: The carrier frequency in Hz.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If `value` is smaller than zero.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The carrier frequency of modeled signals must be non-negative&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_carrier_frequency</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">b</span><span class="o">.</span><span class="n">_carrier_frequency</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">noise_power</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Noise power of the superimposed noise signal.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If the noise power is smaller than zero.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_noise_power</span>

    <span class="nd">@noise_power</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">noise_power</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Noise power must be greater or equal to zero&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_noise_power</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">b</span><span class="o">.</span><span class="n">_noise_power</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">power</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The power of each modeled stream within a numpy vector.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_samples</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_streams</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_samples</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">energy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The energy of each modeled stream within a numpy vector.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">b</span><span class="o">.</span><span class="n">energy</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">timestamps</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The sample-points of the signal block.</span>

<span class="sd">        Vector of length T containing sample-timestamps in seconds.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_samples</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">frequencies</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The signal model&#39;s discrete sample points in frequcy domain.</span>

<span class="sd">        Numpy vector of frequency bins.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">fftfreq</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_samples</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">duration</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Signal model duration in time-domain.</span>

<span class="sd">        Duration in seconds.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_samples</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">title</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Dense Signal Model&quot;</span>  <span class="c1"># pragma: no cover</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SamplesVisualization</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Visualize the samples of the signal model.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_samples_visualization</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">eye</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_EyeVisualization</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Visualize the eye diagram of the signal model.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eye_visualization</span>

<div class="viewcode-block" id="Signal.copy">
<a class="viewcode-back" href="../../../api/core/signal.html#hermespy.core.signal_model.Signal.copy">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Signal</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Copy this signal model to a new object.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>


<div class="viewcode-block" id="Signal.resample">
<a class="viewcode-back" href="../../../api/core/signal.html#hermespy.core.signal_model.Signal.resample">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">resample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">aliasing_filter</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Signal</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Resample the modeled signal to a different sampling rate.</span>

<span class="sd">        Args:</span>

<span class="sd">            sampling_rate:</span>
<span class="sd">                Sampling rate of the new signal model in Hz.</span>

<span class="sd">            aliasing_filter:</span>
<span class="sd">                Apply an anti-aliasing filter during downsampling.</span>
<span class="sd">                Enabled by default.</span>

<span class="sd">        Returns: The resampled signal model.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If `sampling_rate` is smaller or equal to zero.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">signal_new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Empty</span><span class="p">(</span><span class="n">num_streams</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_streams</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">signal_new</span><span class="o">.</span><span class="n">_blocks</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">b</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="p">,</span> <span class="n">aliasing_filter</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span>
        <span class="p">]</span>
        <span class="n">signal_new</span><span class="o">.</span><span class="n">_sampling_rate</span> <span class="o">=</span> <span class="n">sampling_rate</span>
        <span class="k">return</span> <span class="n">signal_new</span></div>


<div class="viewcode-block" id="Signal.superimpose">
<a class="viewcode-back" href="../../../api/core/signal.html#hermespy.core.signal_model.Signal.superimpose">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">superimpose</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">added_signal</span><span class="p">:</span> <span class="n">Signal</span><span class="p">,</span>
        <span class="n">resample</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">aliasing_filter</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">stream_indices</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Superimpose an additive signal model to this model.</span>

<span class="sd">        Internally re-samples `added_signal` to this model&#39;s sampling rate, if required.</span>
<span class="sd">        Mixes `added_signal` according to the carrier-frequency distance.</span>

<span class="sd">        Args:</span>
<span class="sd">            added_signal: The signal to be superimposed onto this one.</span>
<span class="sd">            resample: Allow for dynamic resampling during superposition.</span>
<span class="sd">            aliasing_filter: Apply an anti-aliasing filter during mixing.</span>
<span class="sd">            stream_indices: Indices of the streams to be mixed.</span>

<span class="sd">        Raises:</span>

<span class="sd">            ValueError: If `added_signal` contains a different number of streams than this signal model.</span>
<span class="sd">            RuntimeError: If resampling is required but not allowd.</span>
<span class="sd">            NotImplementedError: If the delays if this signal and `added_signal` differ.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Do nothing if the added signal is empty</span>
        <span class="k">if</span> <span class="n">added_signal</span><span class="o">.</span><span class="n">num_samples</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># Parse stream indices</span>
        <span class="n">num_streams</span> <span class="o">=</span> <span class="n">added_signal</span><span class="o">.</span><span class="n">num_streams</span> <span class="k">if</span> <span class="n">stream_indices</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">len</span><span class="p">(</span><span class="n">stream_indices</span><span class="p">)</span>
        <span class="n">_stream_indices</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_streams</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">stream_indices</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">stream_indices</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int_</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># Abort if zero streams are selected</span>
        <span class="c1"># This case occurs frequently when devices transmit to devices without receiving antennas</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">_stream_indices</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># Validate</span>
        <span class="k">if</span> <span class="n">_stream_indices</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_streams</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stream indices must be in the interval [0, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">num_streams</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">delay</span> <span class="o">!=</span> <span class="n">added_signal</span><span class="o">.</span><span class="n">delay</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                <span class="s2">&quot;Superimposing signal models of differing delay is not yet supported&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">added_signal</span><span class="o">.</span><span class="n">sampling_rate</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">resample</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Resampling required but not allowed&quot;</span><span class="p">)</span>

        <span class="c1"># Apply an aliasing filter to the added signal</span>
        <span class="n">frequency_distance</span> <span class="o">=</span> <span class="n">added_signal</span><span class="o">.</span><span class="n">carrier_frequency</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">carrier_frequency</span>
        <span class="n">filter_center_frequency</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">frequency_distance</span>
        <span class="n">filter_bandwidth</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">added_signal</span><span class="o">.</span><span class="n">sampling_rate</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">)</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span>
            <span class="n">frequency_distance</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">filter_bandwidth</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">added_signal_copy</span> <span class="o">=</span> <span class="n">added_signal</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">aliasing_filter</span> <span class="ow">and</span> <span class="n">filter_bandwidth</span> <span class="o">&lt;</span> <span class="n">added_signal</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">:</span>
            <span class="n">filter_coefficients</span> <span class="o">=</span> <span class="n">firwin</span><span class="p">(</span>
                <span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_order</span><span class="p">,</span>
                <span class="mf">0.5</span> <span class="o">*</span> <span class="n">filter_bandwidth</span><span class="p">,</span>
                <span class="n">width</span><span class="o">=</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">filter_bandwidth</span><span class="p">,</span>
                <span class="n">fs</span><span class="o">=</span><span class="n">added_signal_copy</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span>
            <span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">complex</span><span class="p">)</span>
            <span class="n">filter_coefficients</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
                <span class="mi">2</span><span class="n">j</span>
                <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
                <span class="o">*</span> <span class="p">(</span><span class="n">filter_center_frequency</span> <span class="o">-</span> <span class="n">added_signal</span><span class="o">.</span><span class="n">carrier_frequency</span><span class="p">)</span>
                <span class="o">/</span> <span class="n">added_signal_copy</span><span class="o">.</span><span class="n">sampling_rate</span>
                <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_order</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">added_signal_copy</span><span class="p">)):</span>
                <span class="n">added_signal_copy</span><span class="o">.</span><span class="n">_blocks</span><span class="p">[</span><span class="n">i</span><span class="p">][:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">convolve1d</span><span class="p">(</span>
                    <span class="n">added_signal_copy</span><span class="o">.</span><span class="n">_blocks</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">filter_coefficients</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
                <span class="p">)</span>

        <span class="c1"># Resample the added signal if the respective sampling rates don&#39;t match</span>
        <span class="n">added_signal_resampled</span> <span class="o">=</span> <span class="n">added_signal_copy</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Append zeros to self if num_samples is to small</span>
        <span class="k">if</span> <span class="n">added_signal_resampled</span><span class="o">.</span><span class="n">num_samples</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_samples</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">append_samples</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_streams</span><span class="p">,</span> <span class="n">added_signal_resampled</span><span class="o">.</span><span class="n">num_samples</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_samples</span><span class="p">),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="c1"># Create new blocks for the signals&#39; intersections</span>
        <span class="c1"># and insert the mix results there</span>
        <span class="n">b_offs</span><span class="p">,</span> <span class="n">b_stops</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_blocks_union</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">,</span> <span class="n">added_signal_resampled</span><span class="o">.</span><span class="n">_blocks</span><span class="p">)</span>
        <span class="n">res_ws</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">b_offs</span><span class="o">.</span><span class="n">size</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
        <span class="n">fd_sr_ratio</span> <span class="o">=</span> <span class="n">frequency_distance</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">b_offs</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
            <span class="n">w_off</span> <span class="o">=</span> <span class="n">b_offs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">w_stop</span> <span class="o">=</span> <span class="n">b_stops</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">w_self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getitem</span><span class="p">((</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="nb">slice</span><span class="p">(</span><span class="n">w_off</span><span class="p">,</span> <span class="n">w_stop</span><span class="p">)))</span>
            <span class="k">if</span> <span class="n">w_self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">w_stop</span> <span class="o">-</span> <span class="n">w_off</span><span class="p">:</span>
                <span class="n">w_self</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">w_self</span><span class="p">,</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_streams</span><span class="p">,</span> <span class="n">w_stop</span> <span class="o">-</span> <span class="n">w_off</span> <span class="o">-</span> <span class="n">w_self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">),</span>
                    <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="p">)</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">w_them</span> <span class="o">=</span> <span class="n">added_signal_resampled</span><span class="o">.</span><span class="n">getitem</span><span class="p">((</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="nb">slice</span><span class="p">(</span><span class="n">w_off</span><span class="p">,</span> <span class="n">w_stop</span><span class="p">)))</span>
            <span class="k">if</span> <span class="n">w_them</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">w_stop</span> <span class="o">-</span> <span class="n">w_off</span><span class="p">:</span>
                <span class="n">w_them</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">w_them</span><span class="p">,</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_streams</span><span class="p">,</span> <span class="n">w_stop</span> <span class="o">-</span> <span class="n">w_off</span> <span class="o">-</span> <span class="n">w_them</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">),</span>
                    <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="p">)</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">mix_sin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">2.0</span><span class="n">j</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">w_off</span><span class="p">,</span> <span class="n">w_stop</span><span class="p">)</span> <span class="o">*</span> <span class="n">fd_sr_ratio</span><span class="p">)</span>
            <span class="n">res_ws</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">w_self</span> <span class="o">+</span> <span class="n">mix_sin</span> <span class="o">*</span> <span class="n">w_them</span><span class="p">)[</span><span class="n">_stream_indices</span><span class="p">]</span>

        <span class="c1"># Construct new signal blocks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span> <span class="o">=</span> <span class="p">[</span><span class="n">SignalBlock</span><span class="p">(</span><span class="n">res_ws</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">b_offs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">b_offs</span><span class="p">))]</span></div>


<div class="viewcode-block" id="Signal.append_samples">
<a class="viewcode-back" href="../../../api/core/signal.html#hermespy.core.signal_model.Signal.append_samples">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">append_samples</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">signal</span><span class="p">:</span> <span class="n">Signal</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Append samples in time-domain to the signal model.</span>

<span class="sd">        Args:</span>
<span class="sd">            signal: The signal to be appended.</span>

<span class="sd">        Raise:</span>
<span class="sd">            ValueError: If the number of streams don&#39;t align.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="o">...</span>  <span class="c1"># pragma: no cover</span></div>


<div class="viewcode-block" id="Signal.append_streams">
<a class="viewcode-back" href="../../../api/core/signal.html#hermespy.core.signal_model.Signal.append_streams">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">append_streams</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">signal</span><span class="p">:</span> <span class="n">Signal</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Append streams to the signal model.</span>

<span class="sd">        Args:</span>
<span class="sd">            signal: The signal to be appended.</span>

<span class="sd">        Raise:</span>
<span class="sd">            ValueError: If the number of samples don&#39;t align.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="o">...</span>  <span class="c1"># pragma: no cover</span></div>


<div class="viewcode-block" id="Signal.to_interleaved">
<a class="viewcode-back" href="../../../api/core/signal.html#hermespy.core.signal_model.Signal.to_interleaved">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_interleaved</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_type</span><span class="p">:</span> <span class="n">Type</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">,</span> <span class="n">scale</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert the complex-valued floating-point model samples to interleaved integers.</span>

<span class="sd">        Args:</span>

<span class="sd">            data_type:</span>
<span class="sd">                Numpy resulting data type.</span>

<span class="sd">            scale:</span>
<span class="sd">                Scale the floating point values to stretch over the whole range of integers.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Numpy array of interleaved samples.</span>
<span class="sd">            Will contain double the samples in time-domain.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Get samples</span>
        <span class="n">samples</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getitem</span><span class="p">()</span>

        <span class="c1"># Scale samples if required</span>
        <span class="k">if</span> <span class="n">scale</span> <span class="ow">and</span> <span class="n">samples</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="p">(</span><span class="n">samples</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">1.0</span> <span class="ow">or</span> <span class="n">samples</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">):</span>
            <span class="n">samples</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">samples</span><span class="p">))</span>  <span class="c1"># pragma: no cover</span>

        <span class="n">samples</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">data_type</span><span class="p">)</span><span class="o">.</span><span class="n">max</span>
        <span class="k">return</span> <span class="n">samples</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">data_type</span><span class="p">)</span></div>


<div class="viewcode-block" id="Signal.from_interleaved">
<a class="viewcode-back" href="../../../api/core/signal.html#hermespy.core.signal_model.Signal.from_interleaved">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_interleaved</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span> <span class="n">interleaved_samples</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">scale</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Signal</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize a signal model from interleaved samples.</span>

<span class="sd">        Args:</span>

<span class="sd">            interleaved_samples:</span>
<span class="sd">                Numpy array of interleaved samples.</span>

<span class="sd">            scale:</span>
<span class="sd">                Scale the samples after interleaving</span>

<span class="sd">            \*\*kwargs:</span>
<span class="sd">                Additional class initialization arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">complex128samples</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">interleaved_samples</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">scale</span><span class="p">:</span>
            <span class="n">complex128samples</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">interleaved_samples</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">max</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">Create</span><span class="p">(</span><span class="n">samples</span><span class="o">=</span><span class="n">complex128samples</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Signal.to_dense">
<a class="viewcode-back" href="../../../api/core/signal.html#hermespy.core.signal_model.Signal.to_dense">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_dense</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DenseSignal</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Concatenate all the blocks in the signal into one block.</span>
<span class="sd">        Accounts for offsets. Warning - if offset values are to big, memory overflow is possible.</span>

<span class="sd">        Returns: Dense form for this signal</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">res_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">res_b</span><span class="p">[:,</span> <span class="n">b</span><span class="o">.</span><span class="n">offset</span> <span class="p">:</span> <span class="n">b</span><span class="o">.</span><span class="n">offset</span> <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">num_samples</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span>
        <span class="k">return</span> <span class="n">DenseSignal</span><span class="p">(</span><span class="n">res_b</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Signal.serialize">
<a class="viewcode-back" href="../../../api/core/signal.html#hermespy.core.signal_model.Signal.serialize">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">process</span><span class="p">:</span> <span class="n">SerializationProcess</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">process</span><span class="o">.</span><span class="n">serialize_floating</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span> <span class="s2">&quot;sampling_rate&quot;</span><span class="p">)</span>
        <span class="n">process</span><span class="o">.</span><span class="n">serialize_floating</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">carrier_frequency</span><span class="p">,</span> <span class="s2">&quot;carrier_frequency&quot;</span><span class="p">)</span>
        <span class="n">process</span><span class="o">.</span><span class="n">serialize_floating</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delay</span><span class="p">,</span> <span class="s2">&quot;delay&quot;</span><span class="p">)</span>
        <span class="n">process</span><span class="o">.</span><span class="n">serialize_floating</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">noise_power</span><span class="p">,</span> <span class="s2">&quot;noise_power&quot;</span><span class="p">)</span>
        <span class="n">process</span><span class="o">.</span><span class="n">serialize_integer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_streams</span><span class="p">,</span> <span class="s2">&quot;num_streams&quot;</span><span class="p">)</span>
        <span class="n">process</span><span class="o">.</span><span class="n">serialize_object_sequence</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">,</span> <span class="s2">&quot;blocks&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Signal.Deserialize">
<a class="viewcode-back" href="../../../api/core/signal.html#hermespy.core.signal_model.Signal.Deserialize">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">Deserialize</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">process</span><span class="p">:</span> <span class="n">DeserializationProcess</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Signal</span><span class="p">:</span>
        <span class="n">sampling_rate</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">deserialize_floating</span><span class="p">(</span><span class="s2">&quot;sampling_rate&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="n">carrier_frequency</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">deserialize_floating</span><span class="p">(</span><span class="s2">&quot;carrier_frequency&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="n">delay</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">deserialize_floating</span><span class="p">(</span><span class="s2">&quot;delay&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="n">noise_power</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">deserialize_floating</span><span class="p">(</span><span class="s2">&quot;noise_power&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="n">num_streams</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">deserialize_integer</span><span class="p">(</span><span class="s2">&quot;num_streams&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">blocks</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">deserialize_object_sequence</span><span class="p">(</span><span class="s2">&quot;blocks&quot;</span><span class="p">,</span> <span class="n">SignalBlock</span><span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">Create</span><span class="p">(</span>
            <span class="n">samples</span><span class="o">=</span><span class="n">blocks</span><span class="p">,</span>
            <span class="n">sampling_rate</span><span class="o">=</span><span class="n">sampling_rate</span><span class="p">,</span>
            <span class="n">carrier_frequency</span><span class="o">=</span><span class="n">carrier_frequency</span><span class="p">,</span>
            <span class="n">delay</span><span class="o">=</span><span class="n">delay</span><span class="p">,</span>
            <span class="n">noise_power</span><span class="o">=</span><span class="n">noise_power</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">res</span><span class="o">.</span><span class="n">_num_streams</span> <span class="o">=</span> <span class="n">num_streams</span>
        <span class="k">return</span> <span class="n">res</span></div>
</div>



<div class="viewcode-block" id="DenseSignal">
<a class="viewcode-back" href="../../../api/core/signal.html#hermespy.core.signal_model.DenseSignal">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">DenseSignal</span><span class="p">(</span><span class="n">Signal</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Dense signal model class.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">samples</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">SignalBlock</span><span class="p">],</span>
        <span class="n">sampling_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="n">carrier_frequency</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">noise_power</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">delay</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">offsets</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Signal model initialization.</span>

<span class="sd">        Args:</span>
<span class="sd">            samples:</span>
<span class="sd">                A MxT matrix containing uniformly sampled base-band samples of the modeled signal.</span>
<span class="sd">                M is the number of individual streams, T the number of available samples.</span>
<span class="sd">                Note that you can pass here a 2D ndarray, a SignalBlock, a Sequence[np.ndarray] or a Sequence[SignalBlock].</span>
<span class="sd">                Given Sequence[SignalBlock], concatenates all signal blocks into one, accounting for their offsets.</span>
<span class="sd">                Given Sequence[np.ndarray], concatenates them all into one matrix sequentially.</span>
<span class="sd">                Warning: do not pass sparse sequences of SignalBlocks here as it can lead to memory bloat. Consider SparseSignal instead.</span>

<span class="sd">            sampling_rate:</span>
<span class="sd">                Sampling rate of the modeled signal in Hz (in the base-band).</span>

<span class="sd">            carrier_frequency:</span>
<span class="sd">                Carrier-frequency of the modeled signal in the radio-frequency band in Hz.</span>
<span class="sd">                Zero by default.</span>

<span class="sd">            noise_power:</span>
<span class="sd">                Power of the noise superimposed to this signal model.</span>
<span class="sd">                Zero by default.</span>

<span class="sd">            delay:</span>
<span class="sd">                Delay of the signal in seconds.</span>
<span class="sd">                Zero by default.</span>

<span class="sd">            offsets:</span>
<span class="sd">                If provided, must be of the same length as the samples argument.</span>
<span class="sd">                If samples argument is not an Sequence[SignalBlock],</span>
<span class="sd">                then offsets will be used to dislocate the blocks in the signal.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Initialize base classes</span>
        <span class="n">Signal</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="c1"># Initialize attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span> <span class="o">=</span> <span class="n">sampling_rate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">carrier_frequency</span> <span class="o">=</span> <span class="n">carrier_frequency</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delay</span> <span class="o">=</span> <span class="n">delay</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">noise_power</span> <span class="o">=</span> <span class="n">noise_power</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_samples_visualization</span> <span class="o">=</span> <span class="n">_SamplesVisualization</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_eye_visualization</span> <span class="o">=</span> <span class="n">_EyeVisualization</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="c1"># Initialize blocks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_samples</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">offsets</span><span class="p">)</span>

<div class="viewcode-block" id="DenseSignal.Create">
<a class="viewcode-back" href="../../../api/core/signal.html#hermespy.core.signal_model.DenseSignal.Create">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">Create</span><span class="p">(</span>
        <span class="n">samples</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
        <span class="n">sampling_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="n">carrier_frequency</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">noise_power</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">delay</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">offsets</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DenseSignal</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">DenseSignal</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="p">,</span> <span class="n">carrier_frequency</span><span class="p">,</span> <span class="n">noise_power</span><span class="p">,</span> <span class="n">delay</span><span class="p">,</span> <span class="n">offsets</span><span class="p">)</span></div>


<div class="viewcode-block" id="DenseSignal.getitem">
<a class="viewcode-back" href="../../../api/core/signal.html#hermespy.core.signal_model.DenseSignal.getitem">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">getitem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">unflatten</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reroutes the argument to the single block of this model.</span>
<span class="sd">        Refer the numpy.ndarray.__getitem__ documentation.</span>
<span class="sd">        The result is always a 2D ndarray.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)[</span><span class="n">key</span><span class="p">]</span>
        <span class="c1"># de-flatten</span>
        <span class="k">if</span> <span class="n">unflatten</span> <span class="ow">and</span> <span class="n">res</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">streams_flattened</span><span class="p">,</span> <span class="n">samples_flattened</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_validate_itemkey</span><span class="p">(</span><span class="n">key</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span>
            <span class="k">if</span> <span class="n">streams_flattened</span> <span class="ow">and</span> <span class="n">samples_flattened</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">reshape</span><span class="p">(())</span>
            <span class="k">elif</span> <span class="n">streams_flattened</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">samples_flattened</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">res</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">res</span></div>


    <span class="k">def</span><span class="w"> </span><span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

<div class="viewcode-block" id="DenseSignal.set_samples">
<a class="viewcode-back" href="../../../api/core/signal.html#hermespy.core.signal_model.DenseSignal.set_samples">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_samples</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">samples</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">SignalBlock</span><span class="p">],</span>
        <span class="n">offsets</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets given samples into this dense signal model.</span>
<span class="sd">        SignalBlock or Sequence[SignalBlock] can be provided in samples.</span>
<span class="sd">        In this case they all will be resampled and the offsets argument will be ignored.</span>
<span class="sd">        A single 2D ndarray can be provided to construct a SignalBlock. Offsets will be ignored.</span>
<span class="sd">        A Sequence[ndarray] can be provided. If no offsets are given, then they all will be concatenated.</span>
<span class="sd">        If offsets are provided, the samples will be concatenated, including zero gaps accounting for offsets.</span>
<span class="sd">        If samples is Sequence[SignalBlock] and offsets are provided, blocks&#39; offsets will be ignored</span>
<span class="sd">        Warning: avoid using sparse offsets as this can cause a memory bloat. Consider SparseSignal instead.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_samples</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">offsets</span><span class="p">)</span>

        <span class="c1"># De-sparsify the samples</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">res</span><span class="p">[:,</span> <span class="n">b</span><span class="o">.</span><span class="n">offset</span> <span class="p">:</span> <span class="n">b</span><span class="o">.</span><span class="n">end</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span> <span class="o">=</span> <span class="p">[</span><span class="n">SignalBlock</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">title</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Dense Signal Model&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">power</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_samples</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_streams</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">power</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">energy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">energy</span>

<div class="viewcode-block" id="DenseSignal.Empty">
<a class="viewcode-back" href="../../../api/core/signal.html#hermespy.core.signal_model.DenseSignal.Empty">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">Empty</span><span class="p">(</span>
        <span class="n">sampling_rate</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">num_streams</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DenseSignal</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">DenseSignal</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">num_streams</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">),</span> <span class="n">sampling_rate</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="DenseSignal.append_samples">
<a class="viewcode-back" href="../../../api/core/signal.html#hermespy.core.signal_model.DenseSignal.append_samples">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">append_samples</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">signal</span><span class="p">:</span> <span class="n">Signal</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Resample the signal</span>
        <span class="n">added_blocks_resampled</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">Signal</span><span class="p">):</span>
            <span class="n">added_blocks_resampled</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">)</span><span class="o">.</span><span class="n">_blocks</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">added_blocks_resampled</span> <span class="o">=</span> <span class="p">[</span><span class="n">signal</span><span class="p">]</span>

        <span class="c1"># Check if all the signal attributes match</span>
        <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">prop</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">prop</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">!=</span> <span class="n">prop</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Signal attribute </span><span class="si">{</span><span class="n">prop</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> does not match&quot;</span><span class="p">)</span>

        <span class="c1"># Adapt number of streams to fit the appended signal if this signal is empty</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_streams</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">SignalBlock</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">signal</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># pragma: no cover</span>
            <span class="p">]</span>

        <span class="c1"># Append all blocks from the signal to self block</span>
        <span class="n">off</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">offset</span>
        <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">added_blocks_resampled</span><span class="p">:</span>
            <span class="n">samples_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">b</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">SignalBlock</span><span class="p">(</span><span class="n">samples_new</span><span class="p">,</span> <span class="n">off</span><span class="p">)</span></div>


<div class="viewcode-block" id="DenseSignal.append_streams">
<a class="viewcode-back" href="../../../api/core/signal.html#hermespy.core.signal_model.DenseSignal.append_streams">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">append_streams</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">signal</span><span class="p">:</span> <span class="n">Signal</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Adapt the number of samples if this signal is empty to match the signal to be appended</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_samples</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">SignalBlock</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">num_streams</span><span class="p">,</span> <span class="n">signal</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
            <span class="p">]</span>

        <span class="c1"># Check if all the signal attributes match</span>
        <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">prop</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">prop</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">!=</span> <span class="n">prop</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Signal attribute </span><span class="si">{</span><span class="n">prop</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> does not match&quot;</span><span class="p">)</span>

        <span class="c1"># Resample the signal</span>
        <span class="n">added_blocks_resampled</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">Signal</span><span class="p">):</span>
            <span class="n">added_blocks_resampled</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">)</span><span class="o">.</span><span class="n">_blocks</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">added_blocks_resampled</span> <span class="o">=</span> <span class="p">[</span><span class="n">signal</span><span class="p">]</span>

        <span class="c1"># Append all blocks from the signal to self block</span>
        <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">added_blocks_resampled</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">SignalBlock</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">b</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">offset</span>
            <span class="p">)</span>

        <span class="c1"># Update _num_streams</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_num_streams</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>


<div class="viewcode-block" id="DenseSignal.to_dense">
<a class="viewcode-back" href="../../../api/core/signal.html#hermespy.core.signal_model.DenseSignal.to_dense">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_dense</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DenseSignal</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span></div>
</div>



<div class="viewcode-block" id="SparseSignal">
<a class="viewcode-back" href="../../../api/core/signal.html#hermespy.core.signal_model.SparseSignal">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">SparseSignal</span><span class="p">(</span><span class="n">Signal</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sparse signal model class.</span>
<span class="sd">    HermesPy signal sparsification can be described as follows.</span>
<span class="sd">    Given M signal streams, N samples are recorded for each stream with some constant temporal sampling rate.</span>
<span class="sd">    Thus, a MxN complex matrix of samples can be constructed.</span>
<span class="sd">    If at some point streams do not contain any recorded/transmitted signal, then fully zeroed columns appear in the matrix.</span>
<span class="sd">    This signal model contains a list of SignalBlocks, each representing non-zero regions of the original samples matrix.</span>
<span class="sd">    Thus, regions with only zeros are avoided.</span>
<span class="sd">    Note, that SignalBlocks are sorted by their offset time and don&#39;t overlap.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">samples</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">SignalBlock</span><span class="p">],</span>
        <span class="n">sampling_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="n">carrier_frequency</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">noise_power</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">delay</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">offsets</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Signal model initialization.</span>

<span class="sd">        Args:</span>
<span class="sd">            samples:</span>
<span class="sd">                A MxT matrix containing uniformly sampled base-band samples of the modeled signal.</span>
<span class="sd">                M is the number of individual streams, T the number of available samples.</span>
<span class="sd">                Note that you can pass here a 2D ndarray, a SignalBlock, a Sequence[np.ndarray] or a Sequence[SignalBlock].</span>
<span class="sd">                Given Sequence[SignalBlock], concatenates all signal blocks into one, accounting for their offsets.</span>
<span class="sd">                Given Sequence[np.ndarray], concatenates them all into one matrix sequentially.</span>

<span class="sd">            sampling_rate:</span>
<span class="sd">                Sampling rate of the modeled signal in Hz (in the base-band).</span>

<span class="sd">            carrier_frequency:</span>
<span class="sd">                Carrier-frequency of the modeled signal in the radio-frequency band in Hz.</span>
<span class="sd">                Zero by default.</span>

<span class="sd">            noise_power:</span>
<span class="sd">                Power of the noise superimposed to this signal model.</span>
<span class="sd">                Zero by default.</span>

<span class="sd">            delay:</span>
<span class="sd">                Delay of the signal in seconds.</span>
<span class="sd">                Zero by default.</span>

<span class="sd">            offsets:</span>
<span class="sd">                If provided, must be of the same length as the samples argument.</span>
<span class="sd">                If samples argument is not an Sequence[SignalBlock],</span>
<span class="sd">                then offsets will be used to dislocate the blocks in the signal.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Initialize base classes</span>
        <span class="n">Signal</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="c1"># Initialize attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span> <span class="o">=</span> <span class="n">sampling_rate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">carrier_frequency</span> <span class="o">=</span> <span class="n">carrier_frequency</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delay</span> <span class="o">=</span> <span class="n">delay</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">noise_power</span> <span class="o">=</span> <span class="n">noise_power</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_samples_visualization</span> <span class="o">=</span> <span class="n">_SamplesVisualization</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_eye_visualization</span> <span class="o">=</span> <span class="n">_EyeVisualization</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="c1"># Initialize blocks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_samples</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">offsets</span><span class="p">)</span>

<div class="viewcode-block" id="SparseSignal.Create">
<a class="viewcode-back" href="../../../api/core/signal.html#hermespy.core.signal_model.SparseSignal.Create">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">Create</span><span class="p">(</span>
        <span class="n">samples</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
        <span class="n">sampling_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="n">carrier_frequency</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">noise_power</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">delay</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">offsets</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SparseSignal</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">SparseSignal</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="p">,</span> <span class="n">carrier_frequency</span><span class="p">,</span> <span class="n">noise_power</span><span class="p">,</span> <span class="n">delay</span><span class="p">,</span> <span class="n">offsets</span><span class="p">)</span></div>


    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">__from_dense</span><span class="p">(</span><span class="n">block</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">SignalBlock</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sparsify given signal samples matrix.&quot;&quot;&quot;</span>

        <span class="c1"># Get block attributes</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">block</span><span class="p">,</span> <span class="s2">&quot;offset&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="c1"># Boundary dimensional cases</span>
        <span class="k">if</span> <span class="n">block</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># a vector of a stream</span>
            <span class="n">block</span> <span class="o">=</span> <span class="n">block</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">block</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>  <span class="c1"># pragma: no cover</span>
        <span class="k">if</span> <span class="n">block</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">block</span><span class="o">.</span><span class="n">nonzero</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># an empty signal</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">SignalBlock</span><span class="p">(</span><span class="n">block</span><span class="p">,</span> <span class="n">offset</span><span class="p">)]</span>

        <span class="c1"># Find nonzero columns indices</span>
        <span class="n">nonzero_cols_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">block</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()[</span>
            <span class="mi">0</span>
        <span class="p">]</span>  <span class="c1"># [3, 4, 5, 6, 12, 13, 14, 16, 17, ...]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nonzero_cols_idx</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="c1"># Calculate nonzero windows offsets and stops</span>
        <span class="n">nz_wins_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ediff1d</span><span class="p">(</span><span class="n">nonzero_cols_idx</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c1"># [0, 0, 0, 5, 0,  0,  1,  0,   ...]</span>
        <span class="n">nz_wins_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">nz_wins_idx</span><span class="o">.</span><span class="n">nonzero</span><span class="p">())</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># [            4,          7,   ...]</span>
        <span class="n">res_offsets</span> <span class="o">=</span> <span class="n">nonzero_cols_idx</span><span class="p">[</span><span class="n">nz_wins_idx</span><span class="p">]</span>  <span class="c1"># [            12,         16,  ...]</span>
        <span class="n">res_offsets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span>
            <span class="n">res_offsets</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">nonzero_cols_idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="p">)</span>  <span class="c1"># Add offset of the first window (3)</span>
        <span class="c1"># Calculate windows stops</span>
        <span class="n">win_stops</span> <span class="o">=</span> <span class="n">nonzero_cols_idx</span><span class="p">[</span><span class="n">nz_wins_idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># [         6,         14,      ...]</span>
        <span class="n">win_stops</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">win_stops</span><span class="p">,</span> <span class="n">nonzero_cols_idx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># Add a stop for the last window</span>
        <span class="n">win_stops</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># [         7,         15,      ...]</span>
        <span class="c1"># Cut the windows</span>
        <span class="k">assert</span> <span class="n">win_stops</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">res_offsets</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">num_windows</span> <span class="o">=</span> <span class="n">win_stops</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_windows</span><span class="p">):</span>
            <span class="n">res_samples</span> <span class="o">=</span> <span class="n">block</span><span class="p">[:,</span> <span class="n">res_offsets</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">:</span> <span class="n">win_stops</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>
            <span class="n">res_offset</span> <span class="o">=</span> <span class="n">offset</span> <span class="o">+</span> <span class="n">res_offsets</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SignalBlock</span><span class="p">(</span><span class="n">res_samples</span><span class="p">,</span> <span class="n">res_offset</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">res</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># parse and validate key</span>
        <span class="n">s00</span><span class="p">,</span> <span class="n">s01</span><span class="p">,</span> <span class="n">s02</span><span class="p">,</span> <span class="n">s10</span><span class="p">,</span> <span class="n">s11</span><span class="p">,</span> <span class="n">s12</span><span class="p">,</span> <span class="n">isboolmask</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_validate_itemkey</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">s02</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">s12</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Only positive steps are implemented&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">s12</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                <span class="s2">&quot;SparseSignal __setitem__ does not support sample stepping yet&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">isboolmask</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;SparseSignal __setitem__ does not support boolean masks yet&quot;</span><span class="p">)</span>
        <span class="n">num_streams</span> <span class="o">=</span> <span class="o">-</span><span class="p">((</span><span class="n">s01</span> <span class="o">-</span> <span class="n">s00</span><span class="p">)</span> <span class="o">//</span> <span class="o">-</span><span class="n">s02</span><span class="p">)</span>
        <span class="n">num_samples</span> <span class="o">=</span> <span class="o">-</span><span class="p">((</span><span class="n">s11</span> <span class="o">-</span> <span class="n">s10</span><span class="p">)</span> <span class="o">//</span> <span class="o">-</span><span class="n">s12</span><span class="p">)</span>

        <span class="c1"># clamp the slices to the actual dimensions</span>
        <span class="n">num_streams</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_streams</span><span class="p">,</span> <span class="n">num_streams</span><span class="p">)</span>
        <span class="n">num_samples</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_samples</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">)</span>
        <span class="n">s01</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_streams</span><span class="p">,</span> <span class="n">s01</span><span class="p">)</span>
        <span class="n">s11</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_samples</span><span class="p">,</span> <span class="n">s11</span><span class="p">)</span>

        <span class="c1"># If insertion happens entirely before the first block</span>
        <span class="k">if</span> <span class="n">s11</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">offset</span><span class="p">:</span>
            <span class="c1"># then create new blocks and insert them into the model</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.0</span><span class="n">j</span><span class="p">:</span>
                    <span class="k">return</span>
                <span class="n">bs_new</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">SignalBlock</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">num_streams</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">),</span> <span class="n">value</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">),</span> <span class="n">s10</span><span class="p">)</span>
                <span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">num_streams</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">))</span>
                <span class="n">bs_new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__from_dense</span><span class="p">(</span><span class="n">SignalBlock</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">s10</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span> <span class="o">=</span> <span class="n">bs_new</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span>
            <span class="k">return</span>

        <span class="c1"># Get sliced streames indices</span>
        <span class="n">stream_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">s00</span><span class="p">,</span> <span class="n">s01</span><span class="p">,</span> <span class="n">s02</span><span class="p">)</span>
        <span class="c1"># Do nothing if no streams are affected</span>
        <span class="k">if</span> <span class="n">stream_idx</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># parse and validate value samples</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>  <span class="c1"># If value is a scalar</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="n">bs_new</span> <span class="o">=</span> <span class="p">(</span>
                <span class="p">[]</span>
                <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.0</span><span class="n">j</span>
                <span class="k">else</span> <span class="p">[</span><span class="n">SignalBlock</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">num_streams</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">),</span> <span class="n">value</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">),</span> <span class="n">s10</span><span class="p">)]</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># else value is a samples matrix</span>
            <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">num_streams</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">))</span>
            <span class="n">bs_new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__from_dense</span><span class="p">(</span><span class="n">SignalBlock</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">s10</span><span class="p">))</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bs_new</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span>  <span class="c1"># pragma: no cover</span>
            <span class="k">if</span> <span class="n">bs_new</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">end</span> <span class="o">-</span> <span class="n">bs_new</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">offset</span> <span class="o">&gt;</span> <span class="n">num_samples</span> <span class="ow">or</span> <span class="n">bs_new</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">num_streams</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Shape mismatch&quot;</span><span class="p">)</span>

        <span class="c1"># Find blocks that will be overwritten or modified.</span>
        <span class="n">b_start</span><span class="p">,</span> <span class="n">b_stop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_affected_blocks</span><span class="p">(</span><span class="n">s10</span><span class="p">,</span> <span class="n">s11</span><span class="p">)</span>

        <span class="c1"># Example:</span>
        <span class="c1">#     s10                   s11</span>
        <span class="c1">#      v                     v</span>
        <span class="c1"># xxxxxxxx0000000xxxx000xxxxxxxxx -- self signal</span>
        <span class="c1">#      yyyyy00yy0000yyyyy0000     -- value</span>
        <span class="c1"># xxxxxyyyyy00yy0000yyyyy0000xxxx -- result</span>
        <span class="c1"># ^   ^                           -- remaining samples from the first affected block</span>
        <span class="c1">#      ^   value samples    ^</span>
        <span class="c1">#                            ^  ^ -- remaining samples from the last affected block</span>

        <span class="c1"># Init the resulting blocks</span>
        <span class="c1"># Here the resulting blocks list is divided</span>
        <span class="c1"># onto 3 parts as on the ascii example.</span>
        <span class="c1"># b_start and b_stop can be sliced partially and will be added to the lists right after.</span>
        <span class="c1"># value argument will be applied only to the middle blocks (_mid).</span>
        <span class="n">blocks_new_beg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">[:</span><span class="n">b_start</span><span class="p">]</span>
        <span class="n">blocks_new_mid</span> <span class="o">=</span> <span class="p">[</span><span class="n">b</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">[</span><span class="n">b_start</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">b_stop</span><span class="p">]]</span>
        <span class="n">blocks_new_end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">[</span><span class="n">b_stop</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>

        <span class="c1"># Cut the first affected block</span>
        <span class="c1"># Example:</span>
        <span class="c1">#      s10                  s10</span>
        <span class="c1">#       v                    v</span>
        <span class="c1"># xxxxxxxxxxxx00000 -&gt; xxxxxxxxxxxx00000</span>
        <span class="c1"># [ b_start  ]         [1st ][2nd ]</span>
        <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">[</span><span class="n">b_start</span><span class="p">]</span>
        <span class="n">cut_col</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">s10</span> <span class="o">-</span> <span class="n">b</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># max is for s10 &lt; self._blocks[0].offset</span>
        <span class="n">b_l</span> <span class="o">=</span> <span class="n">b</span><span class="p">[:,</span> <span class="p">:</span><span class="n">cut_col</span><span class="p">]</span>
        <span class="n">b_r</span> <span class="o">=</span> <span class="n">b</span><span class="p">[:,</span> <span class="n">cut_col</span><span class="p">:]</span>
        <span class="n">b_r</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="n">cut_col</span>
        <span class="k">if</span> <span class="n">b_l</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">blocks_new_beg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b_l</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">b_r</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">blocks_new_mid</span> <span class="o">=</span> <span class="p">[</span><span class="n">b_r</span><span class="p">]</span> <span class="o">+</span> <span class="n">blocks_new_mid</span>

        <span class="c1"># Cut the last affected block</span>
        <span class="k">if</span> <span class="n">b_start</span> <span class="o">!=</span> <span class="n">b_stop</span><span class="p">:</span>
            <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">[</span><span class="n">b_stop</span><span class="p">]</span>
            <span class="n">cut_col</span> <span class="o">=</span> <span class="n">s11</span> <span class="o">-</span> <span class="n">b</span><span class="o">.</span><span class="n">offset</span>
            <span class="n">b_l</span> <span class="o">=</span> <span class="n">b</span><span class="p">[:,</span> <span class="p">:</span><span class="n">cut_col</span><span class="p">]</span>
            <span class="n">b_r</span> <span class="o">=</span> <span class="n">b</span><span class="p">[:,</span> <span class="n">cut_col</span><span class="p">:]</span>
            <span class="n">b_r</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="n">cut_col</span>
            <span class="k">if</span> <span class="n">b_l</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">blocks_new_mid</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b_l</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">b_r</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">blocks_new_end</span> <span class="o">=</span> <span class="p">[</span><span class="n">b_r</span><span class="p">]</span> <span class="o">+</span> <span class="n">blocks_new_end</span>

        <span class="c1"># If only some of the streams are being replaced,</span>
        <span class="c1"># then block merging must be performed.</span>
        <span class="k">if</span> <span class="n">stream_idx</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_streams</span><span class="p">:</span>
            <span class="n">b_offs</span><span class="p">,</span> <span class="n">b_stops</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_blocks_union</span><span class="p">(</span><span class="n">blocks_new_mid</span><span class="p">,</span> <span class="n">bs_new</span><span class="p">)</span>

            <span class="c1"># Asseble the new blocks</span>
            <span class="n">incoming_signal</span> <span class="o">=</span> <span class="n">SparseSignal</span><span class="p">(</span><span class="n">bs_new</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">blocks_new_mid_new</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">b_offs</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
                <span class="n">b_off</span> <span class="o">=</span> <span class="n">b_offs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">b_stop</span> <span class="o">=</span> <span class="n">b_stops</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">b_new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getitem</span><span class="p">((</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="nb">slice</span><span class="p">(</span><span class="n">b_off</span><span class="p">,</span> <span class="n">b_stop</span><span class="p">)))</span>
                <span class="n">b_new</span><span class="p">[</span><span class="n">stream_idx</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">incoming_signal</span><span class="o">.</span><span class="n">getitem</span><span class="p">(</span>
                    <span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="nb">slice</span><span class="p">(</span><span class="n">b_off</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">b_stop</span><span class="p">,</span> <span class="n">s11</span><span class="p">)))</span>
                <span class="p">)</span>
                <span class="n">blocks_new_mid_new</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SignalBlock</span><span class="p">(</span><span class="n">b_new</span><span class="p">,</span> <span class="n">b_off</span><span class="p">))</span>
            <span class="n">blocks_new_mid</span> <span class="o">=</span> <span class="n">blocks_new_mid_new</span>

        <span class="c1"># Otherwise, the middle blocks are being simply replaced with the new ones</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">blocks_new_mid</span> <span class="o">=</span> <span class="n">bs_new</span>

        <span class="c1"># Insert the result into this sparse signal model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span> <span class="o">=</span> <span class="n">blocks_new_beg</span> <span class="o">+</span> <span class="n">blocks_new_mid</span> <span class="o">+</span> <span class="n">blocks_new_end</span>
        <span class="c1"># merge new beginning blocks if needed</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">blocks_new_beg</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">b2_idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">blocks_new_beg</span><span class="p">)</span>
            <span class="n">b1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">[</span><span class="n">b2_idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">b2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">[</span><span class="n">b2_idx</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">b1</span><span class="o">.</span><span class="n">end</span> <span class="o">==</span> <span class="n">b2</span><span class="o">.</span><span class="n">offset</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">[</span><span class="n">b2_idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">b1</span><span class="o">.</span><span class="n">append_samples</span><span class="p">(</span><span class="n">b2</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">b2_idx</span><span class="p">)</span>
        <span class="c1"># merge new ending blocks if needed</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">blocks_new_end</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">b2_idx</span> <span class="o">=</span> <span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">blocks_new_end</span><span class="p">)</span>
            <span class="n">b1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">[</span><span class="n">b2_idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">b2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">[</span><span class="n">b2_idx</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">b1</span><span class="o">.</span><span class="n">end</span> <span class="o">==</span> <span class="n">b2</span><span class="o">.</span><span class="n">offset</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">[</span><span class="n">b2_idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">b1</span><span class="o">.</span><span class="n">append_samples</span><span class="p">(</span><span class="n">b2</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">b2_idx</span><span class="p">)</span>

<div class="viewcode-block" id="SparseSignal.set_samples">
<a class="viewcode-back" href="../../../api/core/signal.html#hermespy.core.signal_model.SparseSignal.set_samples">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_samples</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">samples</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">SignalBlock</span><span class="p">],</span>
        <span class="n">offsets</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets given samples into this sparse signal model.</span>

<span class="sd">        Usage:</span>
<span class="sd">            samples:</span>
<span class="sd">                In this case samples array (a 2D complex matrix) will be divided onto several non-zero blocks.</span>

<span class="sd">            samples:</span>
<span class="sd">                In this case all entries (2D complex matrices) will be concatenated among the samples axis and sparsified.</span>

<span class="sd">            samples:</span>
<span class="sd">                In this case SignalBlocks will be constructed directly out of the samples entries, avoiding sparsification.</span>
<span class="sd">                Note that number of offsets entries must equal to the number of samples entries.</span>
<span class="sd">                Offsets must be sorted in an increasing order and samples entries must not overlap</span>
<span class="sd">                (e.g. `offsets[i] + samples[i].shape[1] &lt; offsets[i+1]`).</span>

<span class="sd">            samples:</span>
<span class="sd">                In this case given SignalBlock will be resampled and sparcified.</span>
<span class="sd">                The block&#39;s offset property will be preserved. Consider setting it to zero beforehand (`samples.offset= 0`).</span>

<span class="sd">            samples:</span>
<span class="sd">                In this case each entry will be resampled and stored in the model, avoiding sparsification.</span>
<span class="sd">                Note that the entries must be sorted by an offset in an increasing order and must not overlap</span>
<span class="sd">                (e.g. `samples[i].offset+ samples[i].num_samples &lt; samples[i+1].off`).</span>

<span class="sd">            samples:</span>
<span class="sd">                In this case the same actions will be taken as in the previous case,</span>
<span class="sd">                but given offsets will be set into the samples entries before resampling.</span>
<span class="sd">                Note that number of offsets entries must equal to the number of samples entries.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_samples</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">offsets</span><span class="p">)</span>

        <span class="c1"># Sparsify the blocks</span>
        <span class="n">new_blocks</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">b_new</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__from_dense</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">b_new</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">new_blocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b_new</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span> <span class="o">=</span> <span class="n">new_blocks</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">title</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Sparse Signal Model&quot;</span>

<div class="viewcode-block" id="SparseSignal.Empty">
<a class="viewcode-back" href="../../../api/core/signal.html#hermespy.core.signal_model.SparseSignal.Empty">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">Empty</span><span class="p">(</span>
        <span class="n">sampling_rate</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">num_streams</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SparseSignal</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">SparseSignal</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">num_streams</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">),</span> <span class="n">sampling_rate</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>
        <span class="n">res</span><span class="o">.</span><span class="n">_num_streams</span> <span class="o">=</span> <span class="n">num_streams</span>
        <span class="k">return</span> <span class="n">res</span></div>


<div class="viewcode-block" id="SparseSignal.append_samples">
<a class="viewcode-back" href="../../../api/core/signal.html#hermespy.core.signal_model.SparseSignal.append_samples">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">append_samples</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">signal</span><span class="p">:</span> <span class="n">Signal</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Check if number of streams match</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_streams</span> <span class="o">!=</span> <span class="n">signal</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Number of streams do not match&quot;</span><span class="p">)</span>

        <span class="c1"># Resample the incoming signal</span>
        <span class="n">_signal</span><span class="p">:</span> <span class="n">Signal</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">Signal</span><span class="p">):</span>
            <span class="n">_signal</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_signal</span> <span class="o">=</span> <span class="p">[</span><span class="n">signal</span><span class="p">]</span>

        <span class="c1"># Check if all the signal attributes match</span>
        <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">_signal</span><span class="p">,</span> <span class="n">prop</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">prop</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">!=</span> <span class="n">prop</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Signal attribute </span><span class="si">{</span><span class="n">prop</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> does not match&quot;</span><span class="p">)</span>

        <span class="c1"># Sparsify all blocks in the incoming signal</span>
        <span class="c1"># and add them to this model</span>
        <span class="n">num_blocks_old</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">)</span>
        <span class="n">self_samples_stop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">end</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">_signal</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">b_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__from_dense</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b_</span><span class="p">)</span>
                <span class="n">b_</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="n">self_samples_stop</span>

        <span class="c1"># Merge the last old and the first new blocks if no gap exists between them</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">num_blocks_old</span><span class="p">:</span>
            <span class="n">b1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">[</span><span class="n">num_blocks_old</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">b2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">[</span><span class="n">num_blocks_old</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">b2</span><span class="o">.</span><span class="n">offset</span> <span class="o">==</span> <span class="n">b1</span><span class="o">.</span><span class="n">end</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">[</span><span class="n">num_blocks_old</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">b1</span><span class="o">.</span><span class="n">append_samples</span><span class="p">(</span><span class="n">b2</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">num_blocks_old</span><span class="p">)</span></div>


<div class="viewcode-block" id="SparseSignal.append_streams">
<a class="viewcode-back" href="../../../api/core/signal.html#hermespy.core.signal_model.SparseSignal.append_streams">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">append_streams</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">signal</span><span class="p">:</span> <span class="n">Signal</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Resample the incoming signal</span>
        <span class="n">_signal</span><span class="p">:</span> <span class="n">Signal</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">Signal</span><span class="p">):</span>
            <span class="n">_signal</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_signal</span> <span class="o">=</span> <span class="p">[</span><span class="n">signal</span><span class="p">]</span>

        <span class="c1"># Check if all the signal attributes match</span>
        <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">_signal</span><span class="p">,</span> <span class="n">prop</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">prop</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">!=</span> <span class="n">prop</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Signal attribute </span><span class="si">{</span><span class="n">prop</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> does not match&quot;</span><span class="p">)</span>

        <span class="c1"># Sparsify all blocks in the incoming signal</span>
        <span class="c1"># and add them to this model</span>
        <span class="n">blocks_incoming</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">_signal</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">b_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__from_dense</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
                <span class="n">blocks_incoming</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b_</span><span class="p">)</span>

        <span class="c1"># Create new resulting blocks</span>
        <span class="n">num_streams</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_streams</span> <span class="o">+</span> <span class="n">signal</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">b_offs</span><span class="p">,</span> <span class="n">b_stops</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_blocks_union</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">,</span> <span class="n">blocks_incoming</span><span class="p">)</span>
        <span class="n">is_signal_oftype_signal</span> <span class="o">=</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">Signal</span><span class="p">)</span>
        <span class="n">blocks_new</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">b_offs</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
            <span class="n">b_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_streams</span><span class="p">,</span> <span class="n">b_stops</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">b_offs</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>
            <span class="n">b1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getitem</span><span class="p">((</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="nb">slice</span><span class="p">(</span><span class="n">b_offs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">b_stops</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
            <span class="k">if</span> <span class="n">is_signal_oftype_signal</span><span class="p">:</span>
                <span class="n">b2</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">getitem</span><span class="p">((</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="nb">slice</span><span class="p">(</span><span class="n">b_offs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">b_stops</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>  <span class="c1"># type: ignore</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">b2</span> <span class="o">=</span> <span class="n">signal</span><span class="p">[:,</span> <span class="n">b_offs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">:</span> <span class="n">b_stops</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>  <span class="c1"># type: ignore</span>
            <span class="n">b_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">blocks_new</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SignalBlock</span><span class="p">(</span><span class="n">b_new</span><span class="p">,</span> <span class="n">b_offs</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

        <span class="c1"># Set the result into the model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span> <span class="o">=</span> <span class="n">blocks_new</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_num_streams</span> <span class="o">=</span> <span class="n">num_streams</span></div>
</div>

</pre></div>
        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Barkhausen Institut gGmbH
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script src="../../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script type="module" src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.esm.min.mjs"></script>
    <script type="module" src="https://cdn.jsdelivr.net/npm/@mermaid-js/layout-elk@0.1.4/dist/mermaid-layout-elk.esm.min.mjs"></script>
    <script type="module">import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.esm.min.mjs";import elkLayouts from "https://cdn.jsdelivr.net/npm/@mermaid-js/layout-elk@0.1.4/dist/mermaid-layout-elk.esm.min.mjs";mermaid.registerLayoutLoaders(elkLayouts);mermaid.initialize({startOnLoad:false});</script>
    <script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script>
    <script type="module">
import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.esm.min.mjs";
window.addEventListener("load", () => mermaid.run());
</script>
    </body>
</html>